parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"pZpx":[function(require,module,exports) {
function t(n){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}var n=function(){for(var t={},n=["Array","Object","Function","Date","RegExp","Float32Array"],e=0;e<n.length;e++)t["[object "+n[e]+"]"]=n[e].toLowerCase();return t}(),e={version:"__CURRENT_SDK_VERSION__",revision:"__REVISION__",config:{},common:{},apps:{},data:{},makeArray:function(t){var n,e=[],r=t.length;for(n=0;n<r;++n)e.push(t[n]);return e},type:function(e){if(null===e)return"null";var r=t(e);return"undefined"===r||"number"===r||"string"===r||"boolean"===r?r:n[Object.prototype.toString.call(e)]},extend:function(t,n){var r,i;for(r in n)i=n[r],"object"==e.type(i)?t[r]=e.extend({},i):"array"==e.type(i)?t[r]=e.extend([],i):t[r]=i;return t},isDefined:function(t){return void 0!==t}},r=e;e.guid={create:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=16*Math.random()|0;return("x"==t?n:3&n|8).toString(16)})}},e.path={delimiter:"/",join:function(){var t,n=arguments.length,r=arguments[0];for(t=0;t<n-1;++t){var i=arguments[t],o=arguments[t+1];if(!e.isDefined(i)||!e.isDefined(o))throw new Error("undefined argument to pc2d.path.join");o[0]!==e.path.delimiter?i&&o&&i[i.length-1]!==e.path.delimiter&&o[0]!==e.path.delimiter?r+=e.path.delimiter+o:r+=o:r=o}return r},normalize:function(t){for(var n=t.startsWith(e.path.delimiter),r=t.endsWith(e.path.delimiter),i=t.split("/"),o="",a=[],h=0;h<i.length;h++)""!==i[h]&&"."!==i[h]&&(".."===i[h]&&a.length>0?a=a.slice(0,a.length-2):(h>0&&a.push(e.path.delimiter),a.push(i[h])));return o=a.join(""),n||o[0]!==e.path.delimiter||(o=o.slice(1)),r&&o[o.length-1]!==e.path.delimiter&&(o+=e.path.delimiter),o},split:function(t){var n=t.split(e.path.delimiter),r=n.slice(n.length-1)[0];return[n.slice(0,n.length-1).join(e.path.delimiter),r]},getBasename:function(t){return e.path.split(t)[1]},getDirectory:function(t){var n=t.split(e.path.delimiter);return n.slice(0,n.length-1).join(e.path.delimiter)},getExtension:function(t){var n=t.split("?")[0].split(".").pop();return n!==t?"."+n:""},isRelativePath:function(t){return"/"!==t.charAt(0)&&null===t.match(/:\/\//)},extractPath:function(t){var n="",r=t.split("/"),i=0;if(r.length>1)if(e.path.isRelativePath(t))if("."===r[0])for(i=0;i<r.length-1;++i)n+=0===i?r[i]:"/"+r[i];else if(".."===r[0])for(i=0;i<r.length-1;++i)n+=0===i?r[i]:"/"+r[i];else for(n=".",i=0;i<r.length-1;++i)n+="/"+r[i];else for(i=0;i<r.length-1;++i)n+=0===i?r[i]:"/"+r[i];return n}},e.string=function(){var t=55296,n=56319,r=56320,i=57343,o=127462,a=127487,h=127995,u=127999,s=65024,f=65039;function c(e,o){var a=e.length;if((o=o||0)<0||o>=a)return null;var h,u=e.charCodeAt(o);return a>1&&u>=t&&u<=n&&(h=e.charCodeAt(o+1))>=r&&h<=i?{code:1024*(u-t)+h-r+65536,long:!0}:{code:u,long:!1}}function p(t,n,e){if(!t)return!1;var r=c(t);if(r){var i=r.code;return i>=n&&i<=e}return!1}function l(e,r){if(r===e.length-1)return 1;if(p(e[r],t,n)){var i=e.substring(r,r+2),c=e.substring(r+2,r+4);return p(c,h,u)||p(i,o,a)&&p(c,o,a)?4:p(c,s,f)?3:2}return p(e[r+1],s,f)?2:1}return{ASCII_LOWERCASE:"abcdefghijklmnopqrstuvwxyz",ASCII_UPPERCASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",ASCII_LETTERS:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",format:function(t){var n,r=0,i=e.makeArray(arguments);for(i.shift(),r=0;r<i.length;r++)n=new RegExp("\\{"+r+"\\}","gi"),t=t.replace(n,i[r]);return t},toBool:function(t,n){if("true"===t)return!0;if(n){if("false"===t)return!1;throw new TypeError("Not a boolean string")}return!1},getCodePoint:function(t,n){var e=c(t,n);return e&&e.code},getCodePoints:function(t){if("string"!=typeof t)throw new TypeError("Not a string");for(var n,e=0,r=[];n=c(t,e);)r.push(n.code),e+=n.long?2:1;return r},getSymbols:function(t){if("string"!=typeof t)throw new TypeError("Not a string");for(var n,e=0,r=t.length,i=[],o=0;e<r;)if(p(n=t[e+(o+=l(t,e+o))],8400,8447)&&(n=t[e+o++]),p(n,s,f)&&(n=t[e+o++]),n&&8205===n.charCodeAt(0))n=t[e+o++];else{var a=t.substring(e,e+o);i.push(a),e+=o,o=0}return i},fromCodePoint:function(){for(var t,n,e,r=[],i=0;i<arguments.length;++i)n=(t=Number(arguments[i]))-65536,e=t>65535?[55296+(n>>10),n%1024+56320]:[t],r.push(String.fromCharCode.apply(null,e));return r.join("")}}}(),Object.assign(e,{hashCode:function(t){for(var n=0,e=0,r=t.length;e<r;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n}}),Object.assign(e,function(){var t=function(){this._isRunning=!1,this._a=0,this._b=0};return Object.assign(t.prototype,{start:function(){this._isRunning=!0,this._a=e.now()},stop:function(){this._isRunning=!1,this._b=e.now()},getMilliseconds:function(){return this._b-this._a}}),{Timer:t,now:"undefined"!=typeof window&&window.performance&&window.performance.now&&window.performance.timing?function(){return window.performance.now()}:Date.now}}()),Object.assign(e,{createURI:function(t){var n="";if((t.authority||t.scheme)&&(t.host||t.hostpath))throw new Error("Can't have 'scheme' or 'authority' and 'host' or 'hostpath' option");if(t.host&&t.hostpath)throw new Error("Can't have 'host' and 'hostpath' option");if(t.path&&t.hostpath)throw new Error("Can't have 'path' and 'hostpath' option");return t.scheme&&(n+=t.scheme+":"),t.authority&&(n+="//"+t.authority),t.host&&(n+=t.host),t.path&&(n+=t.path),t.hostpath&&(n+=t.hostpath),t.query&&(n+="?"+t.query),t.fragment&&(n+="#"+t.fragment),n},URI:function(t){var n=t.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/);this.scheme=n[2],this.authority=n[4],this.path=n[5],this.query=n[7],this.fragment=n[9],this.toString=function(){var t="";return this.scheme&&(t+=this.scheme+":"),this.authority&&(t+="//"+this.authority),t+=this.path,this.query&&(t+="?"+this.query),this.fragment&&(t+="#"+this.fragment),t},this.getQuery=function(){var t,n={};return this.query&&decodeURIComponent(this.query).split("&").forEach(function(e,r,i){t=e.split("="),n[t[0]]=t[1]},this),n},this.setQuery=function(t){var n="";for(var e in t)t.hasOwnProperty(e)&&(""!==n&&(n+="&"),n+=encodeURIComponent(e)+"="+encodeURIComponent(t[e]));this.query=n}}}),window.pc2d=e,window.pc=window.pc2d,"undefined"!=typeof exports&&(exports.pc2d=e);
},{}],"Wzxt":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var c=function(){this._callbacks={},this._callbackActive={}};return Object.assign(c.prototype,{_addCallback:function(c,a,t,l){c&&"string"==typeof c&&a&&(this._callbacks[c]||(this._callbacks[c]=[]),this._callbackActive[c]&&this._callbackActive[c]===this._callbacks[c]&&(this._callbackActive[c]=this._callbackActive[c].slice()),this._callbacks[c].push({callback:a,scope:t||this,once:l||!1}))},on:function(c,a,t){return this._addCallback(c,a,t,!1),this},off:function(c,a,t){if(c)this._callbackActive[c]&&this._callbackActive[c]===this._callbacks[c]&&(this._callbackActive[c]=this._callbackActive[c].slice());else for(var l in this._callbackActive)this._callbacks[l]&&this._callbacks[l]===this._callbackActive[l]&&(this._callbackActive[l]=this._callbackActive[l].slice());if(c)if(a){var i=this._callbacks[c];if(!i)return this;for(var s=i.length,e=0;e<s;e++)i[e].callback===a&&(t&&i[e].scope!==t||(i[e--]=i[--s]));i.length=s}else this._callbacks[c]&&(this._callbacks[c]=[]);else this._callbacks={};return this},fire:function(c,a,t,l,i,s,e,n,h){if(!c||!this._callbacks[c])return this;var b;this._callbackActive[c]?(this._callbackActive[c]===this._callbacks[c]&&(this._callbackActive[c]=this._callbackActive[c].slice()),b=this._callbacks[c].slice()):this._callbackActive[c]=this._callbacks[c];for(var k=0;(b||this._callbackActive[c])&&k<(b||this._callbackActive[c]).length;k++){var _=(b||this._callbackActive[c])[k];if(_.callback.call(_.scope,a,t,l,i,s,e,n,h),_.once){var r=this._callbacks[c].indexOf(_);-1!==r&&(this._callbackActive[c]===this._callbacks[c]&&(this._callbackActive[c]=this._callbackActive[c].slice()),this._callbacks[c].splice(r,1))}}return b||(this._callbackActive[c]=null),this},once:function(c,a,t){return this._addCallback(c,a,t,!0),this},hasEvent:function(c){return this._callbacks[c]&&0!==this._callbacks[c].length||!1}}),{EventHandler:c}}()),pc2d.events={attach:function(c){var a=pc2d.events;return c.on=a.on,c.off=a.off,c.fire=a.fire,c.once=a.once,c.hasEvent=a.hasEvent,c._callbacks={},c._callbackActive={},c},on:pc2d.EventHandler.prototype.on,off:pc2d.EventHandler.prototype.off,fire:pc2d.EventHandler.prototype.fire,once:pc2d.EventHandler.prototype.once,hasEvent:pc2d.EventHandler.prototype.hasEvent};
},{}],"rRJb":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=function(t){this._index={},this._key=t||null};Object.assign(t.prototype,{addItem:function(t){for(var i=t.tags._list,e=0;e<i.length;e++)this.add(i[e],t)},removeItem:function(t){for(var i=t.tags._list,e=0;e<i.length;e++)this.remove(i[e],t)},add:function(t,i){this._index[t]&&-1!==this._index[t].list.indexOf(i)||(this._index[t]||(this._index[t]={list:[]},this._key&&(this._index[t].keys={})),this._index[t].list.push(i),this._key&&(this._index[t].keys[i[this._key]]=i))},remove:function(t,i){if(this._index[t]&&(!this._key||this._index[t].keys[i[this._key]])){var e=this._index[t].indexOf(i);-1!==e&&(this._index[t].list.splice(e,1),this._key&&delete this._index[t].keys[i[this._key]],0===this._index[t].list.length&&delete this._index[t])}},find:function(t){var i,e,s,n,h,r,l,_,f=this,o={},a=[],d=function(t,i){return f._index[t].list.length-f._index[i].list.length};for(i=0;i<t.length;i++){if((h=t[i])instanceof Array){if(0===h.length)continue;if(1!==h.length){for(_=!1,s=0;s<h.length;s++)if(!this._index[h[s]]){_=!0;break}if(_)continue;for(1===(l=(r=h.slice(0).sort(d)).slice(1)).length&&(l=l[0]),e=0;e<this._index[r[0]].list.length;e++)n=this._index[r[0]].list[e],(this._key?!o[n[this._key]]:-1===a.indexOf(n))&&n.tags.has(l)&&(this._key&&(o[n[this._key]]=!0),a.push(n));continue}h=h[0]}if(h&&"string"==typeof h&&this._index[h])for(e=0;e<this._index[h].list.length;e++)n=this._index[h].list[e],this._key?o[n[this._key]]||(o[n[this._key]]=!0,a.push(n)):-1===a.indexOf(n)&&a.push(n)}return a}});var i=function(t){pc2d.EventHandler.call(this),this._index={},this._list=[],this._parent=t};return(i.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=i,Object.assign(i.prototype,{add:function(){var t=!1,i=this._processArguments(arguments,!0);if(!i.length)return t;for(var e=0;e<i.length;e++)this._index[i[e]]||(t=!0,this._index[i[e]]=!0,this._list.push(i[e]),this.fire("add",i[e],this._parent));return t&&this.fire("change",this._parent),t},remove:function(){var t=!1;if(!this._list.length)return t;var i=this._processArguments(arguments,!0);if(!i.length)return t;for(var e=0;e<i.length;e++)this._index[i[e]]&&(t=!0,delete this._index[i[e]],this._list.splice(this._list.indexOf(i[e]),1),this.fire("remove",i[e],this._parent));return t&&this.fire("change",this._parent),t},clear:function(){if(this._list.length){var t=this._list.slice(0);this._list=[],this._index={};for(var i=0;i<t.length;i++)this.fire("remove",t[i],this._parent);this.fire("change",this._parent)}},has:function(){return!!this._list.length&&this._has(this._processArguments(arguments))},_has:function(t){if(!this._list.length||!t.length)return!1;for(var i=0;i<t.length;i++)if(1===t[i].length){if(this._index[t[i][0]])return!0}else{for(var e=!0,s=0;s<t[i].length;s++)if(!this._index[t[i][s]]){e=!1;break}if(e)return!0}return!1},list:function(){return this._list.slice(0)},_processArguments:function(t,i){var e=[],s=[];if(!t||!t.length)return e;for(var n=0;n<t.length;n++)if(t[n]instanceof Array){i||(s=[]);for(var h=0;h<t[n].length;h++)"string"==typeof t[n][h]&&(i?e.push(t[n][h]):s.push(t[n][h]));!i&&s.length&&e.push(s)}else"string"==typeof t[n]&&(i?e.push(t[n]):e.push([t[n]]));return e}}),Object.defineProperty(i.prototype,"size",{get:function(){return this._list.length}}),{TagsCache:t,Tags:i}}());
},{}],"URv2":[function(require,module,exports) {
pc2d.math={DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,clamp:function(n,t,r){return n>=r?r:n<=t?t:n},intToBytes24:function(n){return[n>>16&255,n>>8&255,255&n]},intToBytes32:function(n){return[n>>24&255,n>>16&255,n>>8&255,255&n]},bytesToInt24:function(n,t,r){return n.length&&(r=n[2],t=n[1],n=n[0]),n<<16|t<<8|r},bytesToInt32:function(n,t,r,e){return n.length&&(e=n[3],r=n[2],t=n[1],n=n[0]),(n<<24|t<<16|r<<8|e)>>>32},lerp:function(n,t,r){return n+(t-n)*pc2d.math.clamp(r,0,1)},lerpAngle:function(n,t,r){return t-n>180&&(t-=360),t-n<-180&&(t+=360),pc2d.math.lerp(n,t,pc2d.math.clamp(r,0,1))},powerOfTwo:function(n){return 0!==n&&!(n&n-1)},nextPowerOfTwo:function(n){return n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,++n},random:function(n,t){var r=t-n;return Math.random()*r+n},smoothstep:function(n,t,r){return r<=n?0:r>=t?1:(r=(r-n)/(t-n))*r*(3-2*r)},smootherstep:function(n,t,r){return r<=n?0:r>=t?1:(r=(r-n)/(t-n))*r*r*(r*(6*r-15)+10)}};
},{}],"tjMb":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(t){if(this.keys=[],this.type=1,this.tension=.5,this._eval=new pc2d.CurveEvaluator(this),t)for(var e=0;e<t.length-1;e+=2)this.keys.push([t[e],t[e+1]]);this.sort()};return Object.assign(t.prototype,{add:function(t,e){for(var n=this.keys,r=n.length,s=0;s<r&&!(n[s][0]>t);s++);var i=[t,e];return this.keys.splice(s,0,i),i},get:function(t){return this.keys[t]},sort:function(){this.keys.sort(function(t,e){return t[0]-e[0]})},value:function(t){return this._eval.evaluate(t,!0)},closest:function(t){for(var e=this.keys,n=e.length,r=2,s=null,i=0;i<n;i++){var a=Math.abs(t-e[i][0]);if(!(r>=a))break;r=a,s=e[i]}return s},clone:function(){var t=new pc2d.Curve;return t.keys=pc2d.extend(t.keys,this.keys),t.type=this.type,t.tension=this.tension,t},quantize:function(t){t=Math.max(t,2);var e=new Float32Array(t),n=1/(t-1);e[0]=this._eval.evaluate(0,!0);for(var r=1;r<t;r++)e[r]=this._eval.evaluate(n*r);return e},quantizeClamped:function(t,e,n){for(var r=this.quantize(t),s=0;s<r.length;++s)r[s]=Math.min(n,Math.max(e,r[s]));return r}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.keys.length}}),{Curve:t,CURVE_LINEAR:0,CURVE_SMOOTHSTEP:1,CURVE_CATMULL:2,CURVE_CARDINAL:3,CURVE_SPLINE:4,CURVE_STEP:5}}());
},{}],"cgEA":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var e=function(){var e;if(this.curves=[],this._type=pc2d.CURVE_SMOOTHSTEP,arguments.length>1)for(e=0;e<arguments.length;e++)this.curves.push(new pc2d.Curve(arguments[e]));else if(0===arguments.length)this.curves.push(new pc2d.Curve);else{var t=arguments[0];if("number"===pc2d.type(t))for(e=0;e<t;e++)this.curves.push(new pc2d.Curve);else for(e=0;e<t.length;e++)this.curves.push(new pc2d.Curve(t[e]))}};return Object.assign(e.prototype,{get:function(e){return this.curves[e]},value:function(e,t){var r=this.curves.length;(t=t||[]).length=r;for(var n=0;n<r;n++)t[n]=this.curves[n].value(e);return t},clone:function(){var e=new pc2d.CurveSet;e.curves=[];for(var t=0;t<this.curves.length;t++)e.curves.push(this.curves[t].clone());return e._type=this._type,e},quantize:function(e){e=Math.max(e,2);for(var t=this.curves.length,r=new Float32Array(e*t),n=1/(e-1),u=0;u<t;u++)for(var s=new pc2d.CurveEvaluator(this.curves[u]),c=0;c<e;c++)r[c*t+u]=s.evaluate(n*c);return r},quantizeClamped:function(e,t,r){for(var n=this.quantize(e),u=0;u<n.length;++u)n[u]=Math.min(r,Math.max(t,n[u]));return n}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.curves.length}}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e;for(var t=0;t<this.curves.length;t++)this.curves[t].type=e}}),{CurveSet:e}}());
},{}],"BW6Q":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(t,i){this._curve=t,this._left=-1/0,this._right=1/0,this._recip=0,this._p0=0,this._p1=0,this._m0=0,this._m1=0,this._reset(i||0)};return Object.assign(t.prototype,{evaluate:function(t,i){var s;(i||t<this._left||t>=this._right)&&this._reset(t);var e=this._curve.type;if(e===pc2d.CURVE_STEP)s=this._p0;else{var _=0===this._recip?0:(t-this._left)*this._recip;s=e===pc2d.CURVE_LINEAR?pc2d.math.lerp(this._p0,this._p1,_):e===pc2d.CURVE_SMOOTHSTEP?pc2d.math.lerp(this._p0,this._p1,_*_*(3-2*_)):this._evaluateHermite(this._p0,this._p1,this._m0,this._m1,_)}return s},_reset:function(t){var i=this._curve.keys,s=i.length;if(s)if(t<i[0][0])this._left=-1/0,this._right=i[0][0],this._recip=0,this._p0=this._p1=i[0][1],this._m0=this._m1=0;else if(t>=i[s-1][0])this._left=i[s-1][0],this._right=1/0,this._recip=0,this._p0=this._p1=i[s-1][1],this._m0=this._m1=0;else{for(var e=0;t>=i[e+1][0];)e++;this._left=i[e][0],this._right=i[e+1][0];var _=1/(this._right-this._left);this._recip=isFinite(_)?_:0,this._p0=i[e][1],this._p1=i[e+1][1],this._isHermite()&&this._calcTangents(i,e)}else this._left=-1/0,this._right=1/0,this._recip=0,this._p0=this._p1=this._m0=this._m1=0},_isHermite:function(){return this._curve.type===pc2d.CURVE_CATMULL||this._curve.type===pc2d.CURVE_CARDINAL||this._curve.type===pc2d.CURVE_SPLINE},_calcTangents:function(t,i){var s,e,_=t[i],h=t[i+1];if(s=0===i?[t[0][0]+(t[0][0]-t[1][0]),t[0][1]+(t[0][1]-t[1][1])]:t[i-1],e=i==t.length-2?[t[i+1][0]+(t[i+1][0]-t[i][0]),t[i+1][1]+(t[i+1][1]-t[i][1])]:t[i+2],this._curve.type===pc2d.CURVE_SPLINE){var r=2*(h[0]-_[0])/(h[0]-s[0]),p=2*(h[0]-_[0])/(e[0]-_[0]);this._m0=this._curve.tension*(isFinite(r)?r:0)*(h[1]-s[1]),this._m1=this._curve.tension*(isFinite(p)?p:0)*(e[1]-_[1])}else{var c=(h[0]-_[0])/(_[0]-s[0]),n=(h[0]-_[0])/(e[0]-h[0]),u=_[1]+(s[1]-_[1])*(isFinite(c)?c:0),a=h[1]+(e[1]-h[1])*(isFinite(n)?n:0),v=this._curve.type===pc2d.CURVE_CATMULL?.5:this._curve.tension;this._m0=v*(h[1]-u),this._m1=v*(a-_[1])}},_evaluateHermite:function(t,i,s,e,_){var h=_*_,r=_+_,p=1-_,c=p*p;return t*((1+r)*c)+s*(_*c)+i*(h*(3-r))+e*(h*(_-1))}}),{CurveEvaluator:t}}());
},{}],"lN7n":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(t,i){t&&2===t.length?(this.x=t[0],this.y=t[1]):(this.x=t||0,this.y=i||0)};return Object.assign(t.prototype,{add:function(t){return this.x+=t.x,this.y+=t.y,this},add2:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},clone:function(){return(new t).copy(this)},copy:function(t){return this.x=t.x,this.y=t.y,this},distance:function(t){var i=this.x-t.x,n=this.y-t.y;return Math.sqrt(i*i+n*n)},dot:function(t){return this.x*t.x+this.y*t.y},equals:function(t){return this.x===t.x&&this.y===t.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSq:function(){return this.x*this.x+this.y*this.y},lerp:function(t,i,n){return this.x=t.x+n*(i.x-t.x),this.y=t.y+n*(i.y-t.y),this},mul:function(t){return this.x*=t.x,this.y*=t.y,this},mul2:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this},normalize:function(){var t=this.x*this.x+this.y*this.y;if(t>0){var i=1/Math.sqrt(t);this.x*=i,this.y*=i}return this},scale:function(t){return this.x*=t,this.y*=t,this},set:function(t,i){return this.x=t,this.y=i,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this},sub2:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},toString:function(){return"["+this.x+", "+this.y+"]"}}),Object.defineProperties(t,{ZERO:{value:new t(0,0)},ONE:{value:new t(1,1)},UP:{value:new t(0,1)},DOWN:{value:new t(0,-1)},RIGHT:{value:new t(1,0)},LEFT:{value:new t(-1,0)}}),{Vec2:t}}());
},{}],"e7O6":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(t,i,s){t&&3===t.length?(this.x=t[0],this.y=t[1],this.z=t[2]):(this.x=t||0,this.y=i||0,this.z=s||0)};return Object.assign(t.prototype,{add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},add2:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},clone:function(){return(new t).copy(this)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},cross:function(t,i){var s=t.x,h=t.y,n=t.z,r=i.x,e=i.y,u=i.z;return this.x=h*u-e*n,this.y=n*r-u*s,this.z=s*e-r*h,this},distance:function(t){var i=this.x-t.x,s=this.y-t.y,h=this.z-t.z;return Math.sqrt(i*i+s*s+h*h)},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},lerp:function(t,i,s){return this.x=t.x+s*(i.x-t.x),this.y=t.y+s*(i.y-t.y),this.z=t.z+s*(i.z-t.z),this},mul:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},mul2:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},normalize:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z;if(t>0){var i=1/Math.sqrt(t);this.x*=i,this.y*=i,this.z*=i}return this},project:function(t){var i=(this.x*t.x+this.y*t.y+this.z*t.z)/(t.x*t.x+t.y*t.y+t.z*t.z);return this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this},set:function(t,i,s){return this.x=t,this.y=i,this.z=s,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},sub2:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},toString:function(){return"["+this.x+", "+this.y+", "+this.z+"]"}}),Object.defineProperties(t,{ZERO:{value:new t(0,0,0)},ONE:{value:new t(1,1,1)},UP:{value:new t(0,1,0)},DOWN:{value:new t(0,-1,0)},RIGHT:{value:new t(1,0,0)},LEFT:{value:new t(-1,0,0)},FORWARD:{value:new t(0,0,-1)},BACK:{value:new t(0,0,1)}}),{Vec3:t}}());
},{}],"Be36":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(t,i,s,h){t&&4===t.length?(this.x=t[0],this.y=t[1],this.z=t[2],this.w=t[3]):(this.x=t||0,this.y=i||0,this.z=s||0,this.w=h||0)};return Object.assign(t.prototype,{add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},add2:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},clone:function(){return(new t).copy(this)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},lerp:function(t,i,s){return this.x=t.x+s*(i.x-t.x),this.y=t.y+s*(i.y-t.y),this.z=t.z+s*(i.z-t.z),this.w=t.w+s*(i.w-t.w),this},mul:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},mul2:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this.w=t.w*i.w,this},normalize:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;if(t>0){var i=1/Math.sqrt(t);this.x*=i,this.y*=i,this.z*=i,this.w*=i}return this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},set:function(t,i,s,h){return this.x=t,this.y=i,this.z=s,this.w=h,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},sub2:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},toString:function(){return"["+this.x+", "+this.y+", "+this.z+", "+this.w+"]"}}),Object.defineProperties(t,{ZERO:{value:new t(0,0,0,0)},ONE:{value:new t(1,1,1,1)}}),{Vec4:t}}());
},{}],"ebdD":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(t){this._sortBy=t.sortBy,this.items=[],this.length=0,this.loopIndex=-1,this._sortHandler=this._doSort.bind(this)};return t.prototype._binarySearch=function(t){for(var i,s,o=0,e=this.items.length-1,n=t[this._sortBy];o<=e;)i=Math.floor((o+e)/2),(s=this.items[i][this._sortBy])<=n?o=i+1:s>n&&(e=i-1);return o},t.prototype._doSort=function(t,i){var s=this._sortBy;return t[s]-i[s]},t.prototype.insert=function(t){var i=this._binarySearch(t);this.items.splice(i,0,t),this.length++,this.loopIndex>=i&&this.loopIndex++},t.prototype.append=function(t){this.items.push(t),this.length++},t.prototype.remove=function(t){var i=this.items.indexOf(t);i<0||(this.items.splice(i,1),this.length--,this.loopIndex>=i&&this.loopIndex--)},t.prototype.sort=function(){var t=this.loopIndex>=0?this.items[this.loopIndex]:null;this.items.sort(this._sortHandler),null!==t&&(this.loopIndex=this.items.indexOf(t))},{SortedLoopArray:t}}());
},{}],"cGaP":[function(require,module,exports) {
Object.assign(pc2d,{ComponentData:function(){}});
},{}],"pcLQ":[function(require,module,exports) {
function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.assign(pc2d,function(){var e=function(t,e){pc2d.EventHandler.call(this),this.system=t,this.entity=e,this.system.schema&&!this._accessorsBuilt&&this.buildAccessors(this.system.schema),this.on("set",function(t,e,n){this.fire("set_"+t,t,e,n)}),this.on("set_enabled",this.onSetEnabled,this)};return(e.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=e,e._buildAccessors=function(e,n){n.forEach(function(n){var o="object"===t(n)?n.name:n;Object.defineProperty(e,o,{get:function(){return this.data[o]},set:function(t){var e=this.data,n=e[o];e[o]=t,this.fire("set",o,n,t)},configurable:!0})}),e._accessorsBuilt=!0},Object.assign(e.prototype,{buildAccessors:function(t){e._buildAccessors(this,t)},onSetEnabled:function(t,e,n){e!==n&&this.entity.enabled&&(n?this.onEnable():this.onDisable())},onEnable:function(){},onDisable:function(){},onPostStateChange:function(){}}),Object.defineProperty(e.prototype,"data",{get:function(){var t=this.system.store[this.entity.getGuid()];return t?t.data:null}}),{Component:e}}());
},{}],"J27z":[function(require,module,exports) {
function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.assign(pc2d,function(){var e=function(t){pc2d.EventHandler.call(this),this.app=t,this.store={},this.schema=[]};function i(t,e){if(!t)return t;switch(e){case"rgb":return t instanceof pc2d.Color?t.clone():new pc2d.Color(t[0],t[1],t[2]);case"rgba":return t instanceof pc2d.Color?t.clone():new pc2d.Color(t[0],t[1],t[2],t[3]);case"vec2":return t instanceof pc2d.Vec2?t.clone():new pc2d.Vec2(t[0],t[1]);case"vec3":return t instanceof pc2d.Vec3?t.clone():new pc2d.Vec3(t[0],t[1],t[2]);case"vec4":return t instanceof pc2d.Vec4?t.clone():new pc2d.Vec4(t[0],t[1],t[2],t[3]);case"boolean":case"number":case"string":case"entity":return t;default:throw new Error("Could not convert unhandled type: "+e)}}return(e.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=e,Object.assign(e,{_helper:function(t,e){for(var i=0,o=t.length;i<o;i++)t[i].f.call(t[i].s,e)},initialize:function(t){this._helper(this._init,t)},postInitialize:function(t){this._helper(this._postInit,t),this.fire("postinitialize",t)},update:function(t,e){this._helper(e?this._toolsUpdate:this._update,t)},fixedUpdate:function(t,e){this._helper(this._fixedUpdate,t)},postUpdate:function(t,e){this._helper(this._postUpdate,t)},_init:[],_postInit:[],_toolsUpdate:[],_update:[],_fixedUpdate:[],_postUpdate:[],bind:function(t,e,i){switch(t){case"initialize":this._init.push({f:e,s:i});break;case"postInitialize":this._postInit.push({f:e,s:i});break;case"update":this._update.push({f:e,s:i});break;case"postUpdate":this._postUpdate.push({f:e,s:i});break;case"fixedUpdate":this._fixedUpdate.push({f:e,s:i});break;case"toolsUpdate":this._toolsUpdate.push({f:e,s:i});break;default:console.error("Component System does not support event",t)}},_erase:function(t,e,i){for(var o=0;o<t.length;o++)t[o].f===e&&t[o].s===i&&t.splice(o--,1)},unbind:function(t,e,i){switch(t){case"initialize":this._erase(this._init,e,i);break;case"postInitialize":this._erase(this._postInit,e,i);break;case"update":this._erase(this._update,e,i);break;case"postUpdate":this._erase(this._postUpdate,e,i);break;case"fixedUpdate":this._erase(this._fixedUpdate,e,i);break;case"toolsUpdate":this._erase(this._toolsUpdate,e,i);break;default:console.error("Component System does not support event",t)}}}),Object.assign(e.prototype,{addComponent:function(t,e){var i=new this.ComponentType(this,t),o=new this.DataType;return e=e||{},this.store[t.getGuid()]={entity:t,data:o},t[this.id]=i,t.c[this.id]=i,this.initializeComponentData(i,e,[]),this.fire("add",t,i),i},removeComponent:function(t){var e=this.store[t.getGuid()],i=t.c[this.id];this.fire("beforeremove",t,i),delete this.store[t.getGuid()],delete t[this.id],delete t.c[this.id],this.fire("remove",t,e.data)},cloneComponent:function(t,e){var i=this.store[t.getGuid()];return this.addComponent(e,i.data)},initializeComponentData:function(e,o,n){var s,a,r,p;o=o||{};for(var c=0,d=n.length;c<d;c++)"object"===t(s=n[c])?(a=s.name,r=s.type):(a=s,r=void 0),void 0!==(p=o[a])?(void 0!==r&&(p=i(p,r)),e[a]=p):e[a]=e.data[a];e.enabled&&e.entity.enabled&&e.onEnable()},getPropertiesOfType:function(e){var i=[];return(this.schema||[]).forEach(function(o){o&&"object"===t(o)&&o.type===e&&i.push(o)}),i},destroy:function(){this.off()}}),pc2d.events.attach(e),e.destroy=function(){e.off("initialize"),e.off("postInitialize"),e.off("toolsUpdate"),e.off("update"),e.off("fixedUpdate"),e.off("postUpdate")},{ComponentSystem:e}}());
},{}],"FU0h":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=function(){this.list=[]};return Object.assign(t.prototype,{add:function(t){var e=t.id;if(this[e])throw new Error(pc2d.string.format("ComponentSystem name '{0}' already registered or not allowed",e));this[e]=t,this.list.push(t)},remove:function(t){var e=t.id;if(!this[e])throw new Error(pc2d.string.format("No ComponentSystem named '{0}' registered",e));delete this[e];var i=this.list.indexOf(this[e]);-1!==i&&this.list.splice(i,1)}}),{ComponentSystemRegistry:t}}());
},{}],"g6C3":[function(require,module,exports) {
Object.assign(pc2d,{ScriptComponentData:function(){this.enabled=!0}});
},{}],"IsKF":[function(require,module,exports) {
function t(i){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(i)}Object.assign(pc2d,function(){var i=function(t,i){pc2d.Component.call(this,t,i),this._scripts=[],this._updateList=new pc2d.SortedLoopArray({sortBy:"__executionOrder"}),this._postUpdateList=new pc2d.SortedLoopArray({sortBy:"__executionOrder"}),this._scriptsIndex={},this._destroyedScripts=[],this._destroyed=!1,this._scriptsData=null,this._oldState=!0,this._enabled=!0,this._beingEnabled=!1,this._isLoopingThroughScripts=!1,this._executionOrder=-1,this.on("set_enabled",this._onSetEnabled,this)};return(i.prototype=Object.create(pc2d.Component.prototype)).constructor=i,i.scriptMethods={initialize:"initialize",postInitialize:"postInitialize",update:"update",postUpdate:"postUpdate",swap:"swap"},Object.assign(i.prototype,{onEnable:function(){this._beingEnabled=!0,this._checkState(),this.entity._beingEnabled||this.onPostStateChange(),this._beingEnabled=!1},onDisable:function(){this._checkState()},onPostStateChange:function(){for(var t,e=this._beginLooping(),s=0,n=this.scripts.length;s<n;s++)(t=this.scripts[s])._initialized&&!t._postInitialized&&t.enabled&&(t._postInitialized=!0,t.postInitialize&&this._scriptMethod(t,i.scriptMethods.postInitialize));this._endLooping(e)},_beginLooping:function(){var t=this._isLoopingThroughScripts;return this._isLoopingThroughScripts=!0,t},_endLooping:function(t){this._isLoopingThroughScripts=t,this._isLoopingThroughScripts||this._removeDestroyedScripts()},_onSetEnabled:function(t,i,e){this._beingEnabled=!0,this._checkState(),this._beingEnabled=!1},_checkState:function(){var t=this.enabled&&this.entity.enabled;if(t!==this._oldState){this._oldState=t,this.fire(t?"enable":"disable"),this.fire("state",t),t?this.system._addComponentToEnabled(this):this.system._removeComponentFromEnabled(this);for(var i,e=this._beginLooping(),s=0,n=this.scripts.length;s<n;s++)(i=this.scripts[s]).enabled=i._enabled;this._endLooping(e)}},_onBeforeRemove:function(){this.fire("remove");for(var t=this._beginLooping(),i=0;i<this.scripts.length;i++){var e=this.scripts[i];e&&this.destroy(e.__scriptType.__name)}this._endLooping(t)},_removeDestroyedScripts:function(){var t=this._destroyedScripts.length;if(t){var i;for(i=0;i<t;i++){var e=this._destroyedScripts[i];this._removeScriptInstance(e)}this._destroyedScripts.length=0,this._resetExecutionOrder(0,this._scripts.length)}},_onInitializeAttributes:function(){for(var t=0,i=this.scripts.length;t<i;t++)this.scripts[t].__initializeAttributes()},_scriptMethod:function(t,i,e){try{t[i](e)}catch(s){t.enabled=!1,t._callbacks&&t._callbacks.error||(console.warn('unhandled exception while calling "'+i+'" for "'+t.__scriptType.__name+'" script: ',s),console.error(s)),t.fire("error",s,i),this.fire("error",t,s,i)}},_onInitialize:function(){for(var t,e=this._scripts,s=this._beginLooping(),n=0,r=e.length;n<r;n++)!(t=e[n])._initialized&&t.enabled&&(t._initialized=!0,t.initialize&&this._scriptMethod(t,i.scriptMethods.initialize));this._endLooping(s)},_onPostInitialize:function(){this.onPostStateChange()},_onUpdate:function(t){var e=this._updateList;if(e.length){var s,n=this._beginLooping();for(e.loopIndex=0;e.loopIndex<e.length;e.loopIndex++)(s=e.items[e.loopIndex]).enabled&&this._scriptMethod(s,i.scriptMethods.update,t);this._endLooping(n)}},_onPostUpdate:function(t){var e=this._postUpdateList;if(e.length){var s,n=this._beginLooping();for(e.loopIndex=0;e.loopIndex<e.length;e.loopIndex++)(s=e.items[e.loopIndex]).enabled&&this._scriptMethod(s,i.scriptMethods.postUpdate,t);this._endLooping(n)}},_insertScriptInstance:function(t,i,e){-1===i?(this._scripts.push(t),t.__executionOrder=e,t.update&&this._updateList.append(t),t.postUpdate&&this._postUpdateList.append(t)):(this._scripts.splice(i,0,t),t.__executionOrder=i,this._resetExecutionOrder(i+1,e+1),t.update&&this._updateList.insert(t),t.postUpdate&&this._postUpdateList.insert(t))},_removeScriptInstance:function(t){var i=this._scripts.indexOf(t);return-1===i?i:(this._scripts.splice(i,1),t.update&&this._updateList.remove(t),t.postUpdate&&this._postUpdateList.remove(t),i)},_resetExecutionOrder:function(t,i){for(var e=t;e<i;e++)this._scripts[e].__executionOrder=e},has:function(t){return!!this._scriptsIndex[t]},get:function(t){var i=this._scriptsIndex[t];return i&&i.instance||null},create:function(t,e){var s=this;e=e||{};var n=t,r=t;if("string"==typeof n?n=this.system.app.scripts.get(n):n&&(r=n.__name),n){if(!this._scriptsIndex[n.__name]||!this._scriptsIndex[n.__name].instance){var o=new n({app:this.system.app,entity:this.entity,enabled:!e.hasOwnProperty("enabled")||e.enabled,attributes:e.attributes}),a=this._scripts.length,p=-1;return"number"==typeof e.ind&&-1!==e.ind&&a>e.ind&&(p=e.ind),this._insertScriptInstance(o,p,a),this._scriptsIndex[n.__name]={instance:o,onSwap:function(){s.swap(n.__name)}},this[n.__name]=o,e.preloading||o.__initializeAttributes(),this.fire("create",n.__name,o),this.fire("create:"+n.__name,o),this.system.app.scripts.on("swap:"+n.__name,this._scriptsIndex[n.__name].onSwap),e.preloading||(o.enabled&&!o._initialized&&(o._initialized=!0,o.initialize&&this._scriptMethod(o,i.scriptMethods.initialize)),o.enabled&&!o._postInitialized&&(o._postInitialized=!0,o.postInitialize&&this._scriptMethod(o,i.scriptMethods.postInitialize))),o}console.warn("script '"+r+"' is already added to entity '"+this.entity.name+"'")}else this._scriptsIndex[r]={awaiting:!0,ind:this._scripts.length},console.warn("script '"+r+"' is not found, awaiting it to be added to registry");return null},destroy:function(t){var i=t,e=t;"string"==typeof e&&(e=this.system.app.scripts.get(e))&&(i=e.__name);var s=this._scriptsIndex[i];if(delete this._scriptsIndex[i],!s)return!1;if(s.instance&&!s.instance._destroyed)if(s.instance.enabled=!1,s.instance._destroyed=!0,this._isLoopingThroughScripts)this._destroyedScripts.push(s.instance);else{var n=this._removeScriptInstance(s.instance);n>=0&&this._resetExecutionOrder(n,this._scripts.length)}return this.system.app.scripts.off("swap:"+i,s.onSwap),delete this[i],this.fire("destroy",i,s.instance||null),this.fire("destroy:"+i,s.instance||null),s.instance&&s.instance.fire("destroy"),!0},swap:function(t){var e=t;"string"==typeof e&&(e=this.system.app.scripts.get(e));var s=this._scriptsIndex[e.__name];if(!s||!s.instance)return!1;var n=s.instance,r=this._scripts.indexOf(n),o=new e({app:this.system.app,entity:this.entity,enabled:n.enabled,attributes:n.__attributes});return!!o.swap&&(o.__initializeAttributes(),this._scripts[r]=o,this._scriptsIndex[e.__name].instance=o,this[e.__name]=o,o.__executionOrder=r,n.update&&this._updateList.remove(n),n.postUpdate&&this._postUpdateList.remove(n),o.update&&this._updateList.insert(o),o.postUpdate&&this._postUpdateList.insert(o),this._scriptMethod(o,i.scriptMethods.swap,n),this.fire("swap",e.__name,o),this.fire("swap:"+e.__name,o),!0)},resolveDuplicatedEntityReferenceProperties:function(t,i){var e=this.entity.script;for(var s in t._scriptsIndex){var n=this.system.app.scripts.get(s);if(n){var r=t._scriptsIndex[s];if(r&&r.instance){var o=e[s].__attributesRaw,a=e[s].__attributes;if(o||a){var p=r.instance.__attributes;for(var c in p)if(p[c]){var h=n.attributes.get(c);if(h&&"entity"===h.type)if(h.array){var d=p[c],_=d.length;if(!_)continue;for(var l=d.slice(),u=0;u<_;u++){var f=l[u]instanceof pc2d.Entity?l[u].getGuid():l[u];i[f]&&(l[u]=o?i[f].getGuid():i[f])}o?o[c]=l:a[c]=l}else{var b=p[c];if(b instanceof pc2d.Entity)b=b.getGuid();else if("string"!=typeof b)continue;i[b]&&(o?o[c]=i[b].getGuid():a[c]=i[b])}}}}}}},move:function(t,i){var e=this._scripts.length;if(i>=e||i<0)return!1;var s=t;"string"!=typeof s&&(s=t.__name);var n=this._scriptsIndex[s];if(!n||!n.instance)return!1;var r=this._scripts.indexOf(n.instance);return-1!==r&&r!==i&&(this._scripts.splice(i,0,this._scripts.splice(r,1)[0]),this._resetExecutionOrder(0,e),this._updateList.sort(),this._postUpdateList.sort(),this.fire("move",s,n.instance,i,r),this.fire("move:"+s,n.instance,i,r),!0)}}),Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled},set:function(t){var i=this._enabled;this._enabled=t,this.fire("set","enabled",i,t)}}),Object.defineProperty(i.prototype,"scripts",{get:function(){return this._scripts},set:function(i){for(var e in this._scriptsData=i,i)if(i.hasOwnProperty(e)){var s=this._scriptsIndex[e];if(s){if("boolean"==typeof i[e].enabled&&(s.enabled=!!i[e].enabled),"object"===t(i[e].attributes))for(var n in i[e].attributes)if(!pc2d.createScript.reservedAttributes[n]){if(!s.__attributes.hasOwnProperty(n)){var r=this.system.app.scripts.get(e);r&&r.attributes.add(n,{})}s[n]=i[e].attributes[n]}}else console.log(this.order)}}}),{ScriptComponent:i}}());
},{}],"nSdp":[function(require,module,exports) {
Object.assign(pc2d,function(){var e=0,t=function(e){pc2d.ComponentSystem.call(this,e),this.id="script",this.app=e,this.ComponentType=pc2d.ScriptComponent,this.DataType=pc2d.ScriptComponentData,this._components=new pc2d.SortedLoopArray({sortBy:"_executionOrder"}),this._enabledComponents=new pc2d.SortedLoopArray({sortBy:"_executionOrder"}),this.preloading=!0,this.on("beforeremove",this._onBeforeRemove,this),pc2d.ComponentSystem.bind("initialize",this._onInitialize,this),pc2d.ComponentSystem.bind("postInitialize",this._onPostInitialize,this),pc2d.ComponentSystem.bind("update",this._onUpdate,this),pc2d.ComponentSystem.bind("postUpdate",this._onPostUpdate,this)};return(t.prototype=Object.create(pc2d.ComponentSystem.prototype)).constructor=t,Object.assign(t.prototype,{initializeComponentData:function(t,n){if(t._executionOrder=e++,this._components.append(t),e>Number.MAX_SAFE_INTEGER&&this._resetExecutionOrder(),t.enabled=!n.hasOwnProperty("enabled")||!!n.enabled,t.enabled&&t.entity.enabled&&this._enabledComponents.append(t),n.hasOwnProperty("order")&&n.hasOwnProperty("scripts")){t._scriptsData=n.scripts;for(var o=0;o<n.order.length;o++)t.create(n.order[o],{enabled:n.scripts[n.order[o]].enabled,attributes:n.scripts[n.order[o]].attributes,preloading:this.preloading})}},cloneComponent:function(e,t){var n,o,i=[],s={};for(n=0;n<e.script._scripts.length;n++){var p=e.script._scripts[n],r=p.__scriptType.__name;i.push(r);var a={};for(o in p.__attributes)a[o]=p.__attributes[o];s[r]={enabled:p._enabled,attributes:a}}for(o in e.script._scriptsIndex)o.awaiting&&i.splice(o.ind,0,o);var d={enabled:e.script.enabled,order:i,scripts:s};return this.addComponent(t,d)},_resetExecutionOrder:function(){e=0;for(var t=0,n=this._components.length;t<n;t++)this._components.items[t]._executionOrder=e++},_callComponentMethod:function(e,t,n){for(e.loopIndex=0;e.loopIndex<e.length;e.loopIndex++)e.items[e.loopIndex][t](n)},_onInitialize:function(){this.preloading=!1,this._callComponentMethod(this._components,"_onInitializeAttributes"),this._callComponentMethod(this._enabledComponents,"_onInitialize")},_onPostInitialize:function(){this._callComponentMethod(this._enabledComponents,"_onPostInitialize")},_onUpdate:function(e){this._callComponentMethod(this._enabledComponents,"_onUpdate",e)},_onPostUpdate:function(e){this._callComponentMethod(this._enabledComponents,"_onPostUpdate",e)},_addComponentToEnabled:function(e){this._enabledComponents.insert(e)},_removeComponentFromEnabled:function(e){this._enabledComponents.remove(e)},_onBeforeRemove:function(e,t){this._components.items.indexOf(t)>=0&&t._onBeforeRemove(),this._removeComponentFromEnabled(t),this._components.remove(t)}}),{ScriptComponentSystem:t}}());
},{}],"qeuV":[function(require,module,exports) {
Object.assign(pc2d,{CssComponentData:function(){this.enabled=!0}});
},{}],"kJIN":[function(require,module,exports) {
Object.assign(pc2d,function(){pc2d.ELEMENTTYPE_GROUP="group",pc2d.ELEMENTTYPE_IMAGE="image",pc2d.ELEMENTTYPE_TEXT="text";var t=function(t,e){pc2d.Component.call(this,t,e),this._beingInitialized=!1,this.entity.on("insert",this._onInsert,this),this._patch(),this._type=pc2d.ELEMENTTYPE_GROUP,this._cssText=null,this._innerText="",this._textureAsset=null,this._image=null,this._text=null,this._group=null,this._drawOrder=0,this.system.app.buildsource||(this.buildinStyle=document.createElement("style"),this.buildinStyle.setAttribute("data-buildin","yes")),this._styleSheets={}};return(t.prototype=Object.create(pc2d.Component.prototype)).constructor=t,Object.assign(t.prototype,{_patch:function(){this.entity._sync=this._sync},_unpatch:function(){this.entity._sync=pc2d.Entity.prototype._sync},_sync:function(){var t=this.css;if(!t.system.app.buildsource){var e="",i=this.name;for(key in"New Entity"!==i&&t.cssText&&(e+="."+i+"{"+t.cssText+"}"),t.styleSheets){var s=t.styleSheets[key];s&&key&&(e+=key+"{"+(s||"")+"}")}t.buildinStyle.innerHTML=e}return this.dom&&(t.type===pc2d.ELEMENTTYPE_IMAGE||t.type===pc2d.ELEMENTTYPE_GROUP?t.textureAsset&&this.dom.setAttribute("data-pc2d-asset-texture",t.textureAsset||""):this.dom.removeAttribute("data-pc2d-asset-texture"),t.type!==pc2d.ELEMENTTYPE_IMAGE&&t.innerText&&(this.dom.innerHTML=t.innerText)),pc2d.Entity.prototype._sync.call(this)},domOn:function(t,e,i){return document.attachEvent&&"undefined"==typeof Windows?(t.attachEvent("on"+e,i),function(){t.detachEvent("on"+e,i)}):(t.addEventListener(e,i,!1),function(){t.removeEventListener(e,i,!1)})},show:function(){this.entity.dom.style.display=""},hide:function(){this.entity.dom.style.display="none"},querySet:function(t,e){this.entity.dom&&this.entity.dom.querySelector(t)&&(this.entity.dom.querySelector(t).innerHTML=e)},_onInsert:function(t){this.entity._dirtifyWorld()},onUpdate:function(){},onEnable:function(){this.system.app.buildsource||this.system.app.root.head.appendChild(this.buildinStyle),this.entity.dom&&(this.entity.dom.style.display=""),this.fire("enablecss")},onDisable:function(){this.system.app.buildsource||this.buildinStyle.parentNode&&this.system.app.root.head.removeChild(this.buildinStyle),this.entity.dom&&(this.entity.dom.style.display="none"),this.fire("disablecss")},onRemove:function(){this.entity.off("insert",this._onInsert,this),this._unpatch(),this.system.app.buildsource||this.buildinStyle.parentNode&&this.system.app.root.head.removeChild(this.buildinStyle),this.off()},addStyleSheet:function(t){return this._styleSheets[t.name]=t.text,t.text},removeStyleSheet:function(t){delete this._styleSheets[t]}}),Object.defineProperty(t.prototype,"styleSheets",{get:function(){return this._styleSheets},set:function(t){var e,i;if(t){for(e in this._styleSheets){var s=!1;for(i in t)if(t[i].name===e){s=!0,this._styleSheets[e]=t[i].text;break}s||this.removeStyleSheet(e)}for(i in t)this._styleSheets[t[i].name]||this.addStyleSheet(t[i])}else for(e in this._styleSheets)this.removeStyleSheet(e)}}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(t){if(t!==this._type||!this.entity.dom){this._type=t;var e=this.entity.dom;if(this.type===pc2d.ELEMENTTYPE_IMAGE?this.entity.dom=document.createElement("IMG"):this.type===pc2d.ELEMENTTYPE_TEXT?this.entity.dom=document.createElement("span"):this.entity.dom=document.createElement("div"),e&&e.parentNode){var i=e.nextSlibing,s=e.childNodes,n=e.parentNode;n.removeChild(e);for(var o=[],h=0;h<s.length;h++)o.push(s[h]);if(o.length)for(h=0;h<o.length;h++)this.entity.dom.appendChild(o[h]);i&&n.insertBefore(this.entity.dom,i),!i&&n.appendChild(this.entity.dom)}e=null}}}),Object.defineProperty(t.prototype,"cssText",{get:function(){return this._cssText},set:function(t){t!==this._cssText&&(this._cssText=t)}}),Object.defineProperty(t.prototype,"innerText",{get:function(){return this._innerText},set:function(t){t!==this._innerText&&(this._innerText=t,this.entity.dom&&this.type!==pc2d.ELEMENTTYPE_IMAGE&&(this.entity.dom.innerHTML=t))}}),Object.defineProperty(t.prototype,"textureAsset",{get:function(){return this._textureAsset},set:function(t){t!==this._textureAsset&&(this._textureAsset=t,this.entity.dom&&(this.type===pc2d.ELEMENTTYPE_IMAGE||this.type===pc2d.ELEMENTTYPE_GROUP?this.textureAsset&&this.entity.dom.setAttribute("data-pc2d-asset-texture",this.textureAsset||""):this.entity.dom.removeAttribute("data-pc2d-asset-texture")))}}),{CssComponent:t}}());
},{}],"PnI4":[function(require,module,exports) {
Object.assign(pc2d,function(){var e=["enabled"],t=function(t){pc2d.ComponentSystem.call(this,t),this.id="css",this.app=t,this.ComponentType=pc2d.CssComponent,this.DataType=pc2d.CssComponentData,this.schema=e,this.on("beforeremove",this._onRemoveComponent,this),pc2d.ComponentSystem.bind("update",this.onUpdate,this)};return(t.prototype=Object.create(pc2d.ComponentSystem.prototype)).constructor=t,pc2d.Component._buildAccessors(pc2d.CssComponent.prototype,e),Object.assign(t.prototype,{initializeComponentData:function(e,t,n){if(void 0!==t.type&&(e.type=t.type),void 0!==t.cssText&&(e.cssText=t.cssText),void 0!==t.textureAsset&&(e.textureAsset=t.textureAsset),t.styleSheets)for(var s in t.styleSheets)e.addStyleSheet(t.styleSheets[s]);void 0!==t.innerText&&(e.innerText=t.innerText),void 0!==t.enabled&&(e.enabled=t.enabled),pc2d.ComponentSystem.prototype.initializeComponentData.call(this,e,t,n),e._beingInitialized=!1},cloneComponent:function(e,t){this.addComponent(t,{}),t.css.type=e.css.type,t.css.textureAsset=e.css.textureAsset,t.css.innerText=e.css.innerText,t.css.enabled=e.css.enabled},onUpdate:function(e){var t=this.store;for(var n in t){var s=t[n].entity,o=s.css;o.enabled&&s.enabled&&o.onUpdate()}},_onRemoveComponent:function(e,t){t.onRemove()}}),{CssComponentSystem:t}}());
},{}],"QnoE":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=function(t){pc2d.EventHandler.call(this),this.name="string"==typeof t?t:"Untitled",this.tags=new pc2d.Tags(this),this._labels={},this._dirtyLocal=!1,this._aabbVer=0,this._frozen=!1,this._dirtyWorld=!1,this._dirtyNormal=!0,this._right=null,this._up=null,this._forward=null,this._parent=null,this._children=[],this._graphDepth=0,this._enabled=!0,this._enabledInHierarchy=!1,this.scaleCompensation=!1};return(t.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=t,Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled&&this._enabledInHierarchy},set:function(t){this._enabled!==t&&(this._enabled=t,this._parent&&!this._parent.enabled||this._notifyHierarchyStateChanged(this,t))}}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent}}),Object.defineProperty(t.prototype,"path",{get:function(){var t=this._parent;if(t){for(var i=this.name;t&&t._parent;)i=pc2d.string.format("{0}/{1}",t.name,i),t=t._parent;return i}return""}}),Object.defineProperty(t.prototype,"root",{get:function(){var t=this._parent;if(!t)return this;for(;t._parent;)t=t._parent;return t}}),Object.defineProperty(t.prototype,"children",{get:function(){return this._children}}),Object.defineProperty(t.prototype,"graphDepth",{get:function(){return this._graphDepth}}),Object.assign(t.prototype,{_notifyHierarchyStateChanged:function(t,i){t._onHierarchyStateChanged(i);for(var r=t._children,n=0,e=r.length;n<e;n++)r[n]._enabled&&this._notifyHierarchyStateChanged(r[n],i)},_onHierarchyStateChanged:function(t){this._enabledInHierarchy=t,t&&!this._frozen&&this._unfreezeParentToRoot()},_cloneInternal:function(t){t.name=this.name;for(var i=this.tags._list,r=0;r<i.length;r++)t.tags.add(i[r]);t._labels=Object.assign({},this._labels),t._dirtyLocal=this._dirtyLocal,t._dirtyWorld=this._dirtyWorld,t._dirtyNormal=this._dirtyNormal,t._aabbVer=this._aabbVer+1,t._enabled=this._enabled,t._enabledInHierarchy=!1},clone:function(){var t=new pc2d.GraphNode;return this._cloneInternal(t),t},find:function(t,i){var r,n,e=[],h=this._children.length;if(t instanceof Function){var a=t;for(a(this)&&e.push(this),r=0;r<h;r++)(n=this._children[r].find(a)).length&&(e=e.concat(n))}else{for(this[t]&&(this[t]instanceof Function?this[t]():this[t])===i&&e.push(this),r=0;r<h;++r)(n=this._children[r].find(t,i)).length&&(e=e.concat(n))}return e},findOne:function(t,i){var r,n=this._children.length,e=null;if(t instanceof Function){var h=t;if(e=h(this))return this;for(r=0;r<n;r++)if(e=this._children[r].findOne(h))return e}else{if(this[t]&&(this[t]instanceof Function?this[t]():this[t])===i)return this;for(r=0;r<n;r++)if(null!==(e=this._children[r].findOne(t,i)))return e}return null},findByTag:function(){var t=this.tags._processArguments(arguments);return this._findByTag(t)},_findByTag:function(t){var i,r,n=[],e=this._children.length;for(i=0;i<e;i++)this._children[i].tags._has(t)&&n.push(this._children[i]),(r=this._children[i]._findByTag(t)).length&&(n=n.concat(r));return n},findByName:function(t){if(this.name===t)return this;for(var i=0;i<this._children.length;i++){var r=this._children[i].findByName(t);if(null!==r)return r}return null},findByPath:function(t){for(var i=t.split("/"),r=this,n=null,e=0,h=i.length;e<h&&r;e++){var a=i[e];n=null;for(var s=r._children,o=0,l=s.length;o<l;o++)if(s[o].name==a){n=s[o];break}r=n}return n},forEach:function(t,i){t.call(i,this);for(var r=this._children,n=0;n<r.length;n++)r[n].forEach(t,i)},isDescendantOf:function(t){for(var i=this._parent;i;){if(i===t)return!0;i=i._parent}return!1},isAncestorOf:function(t){return t.isDescendantOf(this)},reparent:function(t,i){var r=this._parent;r&&r.removeChild(this),t&&(i>=0?t.insertChild(this,i):t.addChild(this))},_dirtifyLocal:function(){this._dirtyLocal||(this._dirtyLocal=!0,this._dirtyWorld||this._dirtifyWorld())},_unfreezeParentToRoot:function(){for(var t=this._parent;t;)t._frozen=!1,t=t._parent},_dirtifyWorld:function(){this._dirtyWorld||this._unfreezeParentToRoot(),this._dirtifyWorldInternal()},_dirtifyWorldInternal:function(){if(!this._dirtyWorld){this._frozen=!1,this._dirtyWorld=!0;for(var t=0;t<this._children.length;t++)this._children[t]._dirtyWorld||this._children[t]._dirtifyWorldInternal()}this._dirtyNormal=!0,this._aabbVer++},addChild:function(t){if(null!==t._parent)throw new Error("GraphNode is already parented");this._children.push(t),this._onInsertChild(t)},addChildAndSaveTransform:function(t){var i=t._parent;i&&i.removeChild(t),this._children.push(t),this._onInsertChild(t)},insertChild:function(t,i){if(null!==t._parent)throw new Error("GraphNode is already parented");this._children.splice(i,0,t),this._onInsertChild(t)},_onInsertChild:function(t){t._parent=this;var i=t._enabled&&this.enabled;t._enabledInHierarchy!==i&&(t._enabledInHierarchy=i,t._notifyHierarchyStateChanged(t,i)),t._updateGraphDepth(),t._dirtifyWorld(),this._frozen&&t._unfreezeParentToRoot(),t.fire&&t.fire("insert",this),this.fire&&this.fire("childinsert",t)},_updateGraphDepth:function(){this._parent?this._graphDepth=this._parent._graphDepth+1:this._graphDepth=0;for(var t=0,i=this._children.length;t<i;t++)this._children[t]._updateGraphDepth()},removeChild:function(t){var i,r=this._children.length;for(i=0;i<r;++i)if(this._children[i]===t)return this._children.splice(i,1),t._parent=null,t.fire&&t.fire("remove",this),void(this.fire&&this.fire("childremove",t))},_sync:function(){this._dirtyLocal&&(this._dirtyLocal=!1)},syncHierarchy:function(){if(this._enabled&&!this._frozen){this._frozen=!0,(this._dirtyLocal||this._dirtyWorld)&&this._sync();for(var t=this._children,i=0,r=t.length;i<r;i++)t[i].syncHierarchy()}}}),{GraphNode:t}}());
},{}],"sEMV":[function(require,module,exports) {
Object.assign(pc2d,function(){var e=function(){};return e.ContentType={FORM_URLENCODED:"application/x-www-form-urlencoded",GIF:"image/gif",JPEG:"image/jpeg",DDS:"image/dds",JSON:"application/json",PNG:"image/png",TEXT:"text/plain",XML:"application/xml",WAV:"audio/x-wav",OGG:"audio/ogg",MP3:"audio/mpeg",MP4:"audio/mp4",AAC:"audio/aac",BIN:"application/octet-stream",BASIS:"image/basis"},e.ResponseType={TEXT:"text",ARRAY_BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json"},e.binaryExtensions=[".model",".wav",".ogg",".mp3",".mp4",".m4a",".aac",".dds",".glb"],e.retryDelay=100,Object.assign(e.prototype,{ContentType:e.ContentType,ResponseType:e.ResponseType,binaryExtensions:e.binaryExtensions,get:function(e,t,n){return"function"==typeof t&&(n=t,t={}),this.request("GET",e,t,n)},post:function(e,t,n,s){return"function"==typeof n&&(s=n,n={}),n.postdata=t,this.request("POST",e,n,s)},put:function(e,t,n,s){return"function"==typeof n&&(s=n,n={}),n.postdata=t,this.request("PUT",e,n,s)},del:function(e,t,n){return"function"==typeof t&&(n=t,t={}),this.request("DELETE",e,t,n)},request:function(t,n,s,o){var a,r,p,i,y,c=!1;if("function"==typeof s&&(o=s,s={}),s.retry&&(s=Object.assign({retries:0,maxRetries:5},s)),s.callback=o,null==s.async&&(s.async=!0),null==s.headers&&(s.headers={}),null!=s.postdata)if(s.postdata instanceof Document)i=s.postdata;else if(s.postdata instanceof FormData)i=s.postdata;else if(s.postdata instanceof Object){var u=s.headers["Content-Type"];switch(void 0===u&&(s.headers["Content-Type"]=e.ContentType.FORM_URLENCODED,u=s.headers["Content-Type"]),u){case e.ContentType.FORM_URLENCODED:i="";var d=!0;for(var T in s.postdata)s.postdata.hasOwnProperty(T)&&(d?d=!1:i+="&",i+=escape(T)+"="+escape(s.postdata[T]));break;default:case e.ContentType.JSON:null==u&&(s.headers["Content-Type"]=e.ContentType.JSON),i=JSON.stringify(s.postdata)}}else i=s.postdata;for(var l in!1===s.cache&&(p=pc2d.time.now(),(a=new pc2d.URI(n)).query?a.query=a.query+"&ts="+p:a.query="ts="+p,n=a.toString()),s.query&&(a=new pc2d.URI(n),r=pc2d.extend(a.getQuery(),s.query),a.setQuery(r),n=a.toString()),(y=new XMLHttpRequest).open(t,n,s.async),y.withCredentials=void 0!==s.withCredentials&&s.withCredentials,y.responseType=s.responseType||this._guessResponseType(n),s.headers)s.headers.hasOwnProperty(l)&&y.setRequestHeader(l,s.headers[l]);y.onreadystatechange=function(){this._onReadyStateChange(t,n,s,y)}.bind(this),y.onerror=function(){this._onError(t,n,s,y),c=!0}.bind(this);try{y.send(i)}catch(f){c||s.error(y.status,y,f)}return y},_guessResponseType:function(t){var n=new pc2d.URI(t),s=pc2d.path.getExtension(n.path);return e.binaryExtensions.indexOf(s)>=0?e.ResponseType.ARRAY_BUFFER:".xml"===s?e.ResponseType.DOCUMENT:e.ResponseType.TEXT},_isBinaryContentType:function(t){return[e.ContentType.MP4,e.ContentType.WAV,e.ContentType.OGG,e.ContentType.MP3,e.ContentType.BIN,e.ContentType.DDS,e.ContentType.BASIS].indexOf(t)>=0},_onReadyStateChange:function(e,t,n,s){if(4===s.readyState)switch(s.status){case 0:"/"!=t[0]?this._onSuccess(e,t,n,s):this._onError(e,t,n,s);break;case 200:case 201:case 206:case 304:this._onSuccess(e,t,n,s);break;default:this._onError(e,t,n,s)}},_onSuccess:function(t,n,s,o){var a,r,p;(r=o.getResponseHeader("Content-Type"))&&(p=r.split(";")[0].trim());try{p===this.ContentType.JSON||n.split("?")[0].endsWith(".json")?a=JSON.parse(o.responseText):this._isBinaryContentType(p)?a=o.response:(p&&logWARNING(pc2d.string.format("responseType: {0} being served with Content-Type: {1}",o.responseType,p)),a=o.responseType===e.ResponseType.ARRAY_BUFFER?o.response:o.responseType===e.ResponseType.BLOB||o.responseType===e.ResponseType.JSON?o.response:o.responseType===e.ResponseType.DOCUMENT||p===this.ContentType.XML?o.responseXML:o.responseText),s.callback(null,a)}catch(i){s.callback(i)}},_onError:function(t,n,s,o){if(!s.retrying)if(s.retry&&s.retries<s.maxRetries){s.retries++,s.retrying=!0;var a=pc2d.math.clamp(Math.pow(2,s.retries)*e.retryDelay,0,s.maxRetryDelay||5e3);console.log(t+": "+n+" - Error "+o.status+". Retrying in "+a+" ms"),setTimeout(function(){s.retrying=!1,this.request(t,n,s,s.callback)}.bind(this),a)}else s.callback(0===o.status?"Network error":o.status,null)}}),{Http:e,http:new e}}());
},{}],"JVpL":[function(require,module,exports) {
Object.assign(pc2d,function(){var e=function e(t,r){if(e.reservedScripts[t])throw new Error("script name: '"+t+"' is reserved, please change script name");var s=function(e){pc2d.ScriptType.call(this,e)};return(s.prototype=Object.create(pc2d.ScriptType.prototype)).constructor=s,s.extend=pc2d.ScriptType.extend,s.attributes=new pc2d.ScriptAttributes(s),pc2d.registerScript(s,t,r),s};e.reservedScripts=["system","entity","create","destroy","swap","move","scripts","_scripts","_scriptsIndex","_scriptsData","enabled","_oldState","onEnable","onDisable","onPostStateChange","_onSetEnabled","_checkState","_onBeforeRemove","_onInitializeAttributes","_onInitialize","_onPostInitialize","_onUpdate","_onPostUpdate","_callbacks","has","get","on","off","fire","once","hasEvent"];var t,r={};for(t=0;t<e.reservedScripts.length;t++)r[e.reservedScripts[t]]=1;e.reservedScripts=r,e.reservedAttributes=["app","entity","enabled","_enabled","_enabledOld","_destroyed","__attributes","__attributesRaw","__scriptType","__executionOrder","_callbacks","has","get","on","off","fire","once","hasEvent"];var s={};for(t=0;t<e.reservedAttributes.length;t++)s[e.reservedAttributes[t]]=1;return e.reservedAttributes=s,{createScript:e,registerScript:function(t,r,s){if("function"!=typeof t)throw new Error("script class: '"+t+"' must be a constructor function (i.e. class).");if(!(t.prototype instanceof pc2d.ScriptType))throw new Error("script class: '"+pc2d.ScriptType.__getScriptName(t)+"' does not extend pc2d.ScriptType.");if(r=r||t.__name||pc2d.ScriptType.__getScriptName(t),e.reservedScripts[r])throw new Error("script name: '"+r+"' is reserved, please change script name");t.__name=r,(s?s.scripts:pc2d.Application.getApplication().scripts).add(t),pc2d.ScriptHandler._push(t)}}}());
},{}],"UOvr":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=new RegExp("^\\s*function(?:\\s|\\s*\\/\\*.*\\*\\/\\s*)+([^\\(\\s\\/]*)\\s*"),i=function(t){pc2d.EventHandler.call(this);var i=this.constructor;t&&t.app&&t.entity||console.warn("script '"+i.__name+"' has missing arguments in constructor"),this.app=t.app,this.entity=t.entity,this._enabled="boolean"!=typeof t.enabled||t.enabled,this._enabledOld=this.enabled,this.__destroyed=!1,this.__attributes={},this.__attributesRaw=t.attributes||{},this.__scriptType=i,this.__executionOrder=-1};return(i.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=i,i.__name=null,i.__getScriptName=function(i){if("function"==typeof i){if("name"in Function.prototype)return i.name;if(i===Function||i===Function.prototype.constructor)return"Function";var e=(""+i).match(t);return e?e[1]:void 0}},Object.defineProperty(i,"attributes",{get:function(){return this.hasOwnProperty("__attributes")||(this.__attributes=new pc2d.ScriptAttributes(this)),this.__attributes}}),i.prototype.__initializeAttributes=function(t){if(t||this.__attributesRaw){for(var i in this.__scriptType.attributes.index)this.__attributesRaw&&this.__attributesRaw.hasOwnProperty(i)?this[i]=this.__attributesRaw[i]:this.__attributes.hasOwnProperty(i)||(this.__scriptType.attributes.index[i].hasOwnProperty("default")?this[i]=this.__scriptType.attributes.index[i].default:this[i]=null);this.__attributesRaw=null}},i.extend=function(t){for(var i in t)t.hasOwnProperty(i)&&(this.prototype[i]=t[i])},Object.defineProperty(i.prototype,"enabled",{get:function(){return this._enabled&&!this._destroyed&&this.entity.script.enabled&&this.entity.enabled},set:function(t){this._enabled=!!t,this.enabled!==this._enabledOld&&(this._enabledOld=this.enabled,this.fire(this.enabled?"enable":"disable"),this.fire("state",this.enabled),!this._initialized&&this.enabled&&(this._initialized=!0,this.__initializeAttributes(!0),this.initialize&&this.entity.script._scriptMethod(this,pc2d.ScriptComponent.scriptMethods.initialize)),this._initialized&&!this._postInitialized&&this.enabled&&!this.entity.script._beingEnabled&&(this._postInitialized=!0,this.postInitialize&&this.entity.script._scriptMethod(this,pc2d.ScriptComponent.scriptMethods.postInitialize)))}}),{ScriptType:i}}());
},{}],"UF00":[function(require,module,exports) {
function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.assign(pc2d,function(){var e=["x","y","z","w"],r=function(r,n,i,s){var o;switch(n.type){case"boolean":return!!i;case"number":if("number"==typeof i)return i;if("string"==typeof i){var c=parseInt(i,10);return isNaN(c)?null:c}return"boolean"==typeof i?0+i:null;case"json":if("object"===t(i))return i;try{return JSON.parse(i)}catch(p){return null}case"asset":return i instanceof pc2d.Asset?i:"number"==typeof i?r.assets.get(i)||null:"string"==typeof i&&r.assets.get(i)||null;case"entity":return i instanceof pc2d.GraphNode?i:"string"==typeof i?r.getEntityFromIndex(i):null;case"rgb":case"rgba":if(i instanceof pc2d.Color)return s instanceof pc2d.Color?(s.copy(i),s):i.clone();if(i instanceof Array&&i.length>=3&&i.length<=4){for(o=0;o<i.length;o++)if("number"!=typeof i[o])return null;return s||(s=new pc2d.Color),s.r=i[0],s.g=i[1],s.b=i[2],s.a=3===i.length?1:i[3],s}return"string"==typeof i&&/#([0-9abcdef]{2}){3,4}/i.test(i)?(s||(s=new pc2d.Color),s.fromString(i),s):null;case"vec2":case"vec3":case"vec4":var u=parseInt(n.type.slice(3),10);if(i instanceof pc2d["Vec"+u])return s instanceof pc2d["Vec"+u]?(s.copy(i),s):i.clone();if(i instanceof Array&&i.length===u){for(o=0;o<i.length;o++)if("number"!=typeof i[o])return null;for(s||(s=new pc2d["Vec"+u]),o=0;o<u;o++)s[e[o]]=i[o];return s}return null;case"curve":if(i){var a;if(i instanceof pc2d.Curve||i instanceof pc2d.CurveSet)a=i.clone();else(a=new(i.keys[0]instanceof Array?pc2d.CurveSet:pc2d.Curve)(i.keys)).type=i.type;return a}}return i},n=function(t){this.scriptType=t,this.index={}};return n.prototype.add=function(t,e){this.index[t]?console.warn("attribute '"+t+"' is already defined for script type '"+this.scriptType.name+"'"):pc2d.createScript.reservedAttributes[t]?console.warn("attribute '"+t+"' is a reserved attribute name"):(this.index[t]=e,Object.defineProperty(this.scriptType.prototype,t,{get:function(){return this.__attributes[t]},set:function(n){var i,s,o=this.__attributes[t];if(e.array){if(this.__attributes[t]=[],n)for(i=0,s=n.length;i<s;i++)this.__attributes[t].push(r(this.app,e,n[i],o?o[i]:null))}else this.__attributes[t]=r(this.app,e,n,o);this.fire("attr",t,this.__attributes[t],o),this.fire("attr:"+t,this.__attributes[t],o)}}))},n.prototype.remove=function(t){return!!this.index[t]&&(delete this.index[t],delete this.scriptType.prototype[t],!0)},n.prototype.has=function(t){return!!this.index[t]},n.prototype.get=function(t){return this.index[t]||null},{ScriptAttributes:n}}());
},{}],"zAKT":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=function(t){pc2d.EventHandler.call(this),this.app=t,this._scripts={},this._list=[]};return(t.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=t,t.prototype.destroy=function(){this.app=null,this.off()},t.prototype.add=function(t){var i=this,s=t.__name;return this._scripts.hasOwnProperty(s)?(setTimeout(function(){if(t.prototype.swap){var e=i._scripts[s],r=i._list.indexOf(e);i._list[r]=t,i._scripts[s]=t,i.fire("swap",s,t),i.fire("swap:"+s,t)}else console.warn("script registry already has '"+s+"' script, define 'swap' method for new script type to enable code hot swapping")}),!1):(this._scripts[s]=t,this._list.push(t),this.fire("add",s,t),this.fire("add:"+s,t),setTimeout(function(){if(i._scripts.hasOwnProperty(s)&&i.app&&i.app.systems&&i.app.systems.script){var t,e,r,p=i.app.systems.script._components,n=[],o=[];for(p.loopIndex=0;p.loopIndex<p.length;p.loopIndex++){var a=p.items[p.loopIndex];a._scriptsIndex[s]&&a._scriptsIndex[s].awaiting&&(a._scriptsData&&a._scriptsData[s]&&(r=a._scriptsData[s].attributes),(e=a.create(s,{preloading:!0,ind:a._scriptsIndex[s].ind,attributes:r}))&&n.push(e))}for(t=0;t<n.length;t++)n[t].__initializeAttributes();for(t=0;t<n.length;t++)n[t].enabled&&(n[t]._initialized=!0,o.push(n[t]),n[t].initialize&&n[t].initialize());for(t=0;t<o.length;t++)o[t].enabled&&!o[t]._postInitialized&&(o[t]._postInitialized=!0,o[t].postInitialize&&o[t].postInitialize())}}),!0)},t.prototype.remove=function(t){var i=t,s=t;if("string"!=typeof s?s=i.__name:i=this.get(s),this.get(s)!==i)return!1;delete this._scripts[s];var e=this._list.indexOf(i);return this._list.splice(e,1),this.fire("remove",s,i),this.fire("remove:"+s,i),!0},t.prototype.get=function(t){return this._scripts[t]||null},t.prototype.has=function(t){if("string"==typeof t)return this._scripts.hasOwnProperty(t);if(!t)return!1;var i=t.__name;return this._scripts[i]===t},t.prototype.list=function(){return this._list},{ScriptRegistry:t}}());
},{}],"gUmX":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=function(t,s){if(pc2d.EventHandler.call(this),this._assets=[],this._registry=s,this._loaded=!1,this._count=0,this._total=0,this._failed=[],this._waitingAssets=[],t.length&&t[0]instanceof pc2d.Asset)this._assets=t;else for(var i=0;i<t.length;i++){var o=s.get(t[i]);o?this._assets.push(o):(this._waitForAsset(t[i]),this._total++)}};return(t.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=t,t.prototype.destroy=function(){var t=this;this._registry.off("load",this._onLoad),this._registry.off("error",this._onError),this._waitingAssets.forEach(function(s){t._registry.off("add:"+s,this._onAddAsset)}),this.off("progress"),this.off("load")},t.prototype.load=function(t,s){var i,o=0,e=this._assets.length;for(this._count=0,this._failed=[],this._callback=t,this._scope=s,this._registry.on("load",this._onLoad,this),this._registry.on("error",this._onError,this),o=0;o<e;o++)(i=this._assets[o]).loading||i.loaded||(this._registry.load(i),this._total++)},t.prototype.ready=function(t,s){s=s||this,this._loaded?t.call(s,this._assets):this.once("load",function(i){t.call(s,i)})},t.prototype._loadingComplete=function(){this._loaded=!0,this._registry.off("load",this._onLoad,this),this._registry.off("error",this._onError,this),this._failed&&this._failed.length?(this._callback&&this._callback.call(this._scope,"Failed to load some assets",this._failed),this.fire("error",this._failed)):(this._callback&&this._callback.call(this._scope),this.fire("load",this._assets))},t.prototype._onLoad=function(t){var s=this;this._assets.indexOf(t)>=0&&(this._count++,this.fire("progress",t)),this._count===this._total&&setTimeout(function(){s._loadingComplete(s._failed)},0)},t.prototype._onError=function(t,s){var i=this;this._assets.indexOf(s)>=0&&(this._count++,this._failed.push(s)),this._count===this._total&&setTimeout(function(){i._loadingComplete(i._failed)},0)},t.prototype._onAddAsset=function(t){var s,i=this._waitingAssets.indexOf(t);i>=0&&this._waitingAssets.splice(i,1),this._assets.push(t);var o=this._assets.length;for(s=0;s<o;s++)(t=this._assets[s]).loading||t.loaded||this._registry.load(t)},t.prototype._waitForAsset=function(t){this._waitingAssets.push(t),this._registry.once("add:"+t,this._onAddAsset,this)},{AssetListLoader:t}}());
},{}],"nAWy":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=[],s=function(t){this.asset=t},e=function(e){var i="_"+e;t.push(i),Object.defineProperty(s.prototype,e,{get:function(){return this[i]||null},set:function(t){(!!this[i]!==!!t||this[i]&&t&&this[i].hash!==t.hash)&&(this[i]=t?{url:t.url,filename:t.filename,size:t.size,hash:t.hash,opt:t.opt||0}:null,this.asset.file&&(this.asset.fire("change",this.asset,"file",this.asset._file,this.asset._file),this.asset.reload()))}})};return e("dxt"),e("pvr"),e("etc1"),e("etc2"),e("basis"),s.prototype.clear=function(){for(var s=0;s<t.length;s++)this[t[s]]=null},{AssetVariants:s}}());
},{}],"yrto":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=-1,e=new RegExp("^\\s*(?:(?:[a-z]+[a-z0-9\\-\\+\\.]*:)?//|data:)","i"),i={pvr:"extCompressedTexturePVRTC",dxt:"extCompressedTextureS3TC",etc2:"extCompressedTextureETC",etc1:"extCompressedTextureETC1",basis:"canvas"},s=["pvr","dxt","etc2","etc1","basis"],r=function(e,i,s,r){pc2d.EventHandler.call(this),this._id=t--,this.name=e||"",this.type=i,this.tags=new pc2d.Tags(this),this._preload=!1,this.variants=new pc2d.AssetVariants(this),this._file=null,this._data=r||{},this._resources=[],this._i18n={},this.loaded=!1,this.loading=!1,this.registry=null,s&&(this.file=s)};return(r.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=r,Object.assign(r.prototype,{getFileUrl:function(){var t=this.getPreferredFile();if(!t||!t.url)return null;var i=t.url;if(this.registry&&this.registry.prefix&&!e.test(i)&&(i=this.registry.prefix+i),"script"!==this.type&&t.hash){var s=-1!==i.indexOf("?")?"&":"?";i+=s+"t="+t.hash}return i},getPreferredFile:function(){if(!this.file)return null;if("texture"===this.type||"textureatlas"===this.type||"bundle"===this.type)for(var t=this.registry._loader._app,e=t.graphicsDevice,r=0,a=s.length;r<a;r++){var h=s[r];if(e[i[h]]){if(this.file.variants[h])return this.file.variants[h];if(t.enableBundles){var n=t.bundles.listBundlesForAsset(this);if(!n)continue;for(var o=0,l=n.length;o<l;o++)if(n[o].file&&n[o].file.variants&&n[o].file.variants[h])return this.file}}}return this.file},getLocalizedAssetId:function(t){return t=pc2d.I18n.findAvailableLocale(t,this._i18n),this._i18n[t]||null},addLocalizedAssetId:function(t,e){this._i18n[t]=e,this.fire("add:localized",t,e)},removeLocalizedAssetId:function(t){var e=this._i18n[t];e&&(delete this._i18n[t],this.fire("remove:localized",t,e))},ready:function(t,e){e=e||this,this.resource?t.call(e,this):this.once("load",function(i){t.call(e,i)})},reload:function(){this.loaded&&("cubemap"===this.type?this.registry._loader.patch(this,this.registry):(this.loaded=!1,this.registry.load(this)))},unload:function(){(this.loaded||this.resource)&&(this.fire("unload",this),this.registry.fire("unload:"+this.id,this),this.resource&&this.resource.destroy&&this.resource.destroy(),this.resource=null,this.loaded=!1,this.file&&this.registry._loader.clearCache(this.getFileUrl(),this.type))}}),Object.defineProperty(r.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t}}),Object.defineProperty(r.prototype,"file",{get:function(){return this._file},set:function(t){var e;if(!!t!==!!this._file||t&&this._file&&t.hash!==this._file)if(t){if(this._file||(this._file={}),this._file.url=t.url,this._file.filename=t.filename,this._file.hash=t.hash,this._file.size=t.size,this._file.variants=this.variants,t.hasOwnProperty("variants")&&(this.variants.clear(),t.variants))for(e in t.variants)t.variants[e]&&(this.variants[e]=t.variants[e]);this.fire("change",this,"file",this._file,this._file),this.reload()}else this._file=null,this.variants.clear();else if(t&&this._file&&t.hasOwnProperty("variants")&&(this.variants.clear(),t.variants))for(e in t.variants)t.variants[e]&&(this.variants[e]=t.variants[e])}}),Object.defineProperty(r.prototype,"data",{get:function(){return this._data},set:function(t){var e=this._data;this._data=t,t!==e&&(this.fire("change",this,"data",t,e),this.loaded&&this.registry._loader.patch(this,this.registry))}}),Object.defineProperty(r.prototype,"resource",{get:function(){return this._resources[0]},set:function(t){var e=this._resources[0];this._resources[0]=t,this.fire("change",this,"resource",t,e)}}),Object.defineProperty(r.prototype,"resources",{get:function(){return this._resources},set:function(t){var e=this._resources;this._resources=t,this.fire("change",this,"resources",t,e)}}),Object.defineProperty(r.prototype,"preload",{get:function(){return this._preload},set:function(t){t=!!t,this._preload!==t&&(this._preload=t,this._preload&&!this.loaded&&!this.loading&&this.registry&&this.registry.load(this))}}),{Asset:r,ASSET_ANIMATION:"animation",ASSET_AUDIO:"audio",ASSET_IMAGE:"image",ASSET_JSON:"json",ASSET_TEXT:"text",ASSET_TEXTURE:"texture",ASSET_SHADER:"shader",ASSET_CSS:"css",ASSET_HTML:"html",ASSET_SCRIPT:"script",ABSOLUTE_URL:e}}());
},{}],"OzPz":[function(require,module,exports) {
Object.assign(pc2d,function(){var e=function(e){pc2d.EventHandler.call(this),this._loader=e,this._assets=[],this._cache={},this._names={},this._tags=new pc2d.TagsCache("_id"),this._urls={},this.prefix=null};return(e.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=e,Object.assign(e.prototype,{list:function(e){return e=e||{},this._assets.filter(function(t){var i=!0;return void 0!==e.preload&&(i=t.preload===e.preload),i})},add:function(e){var t,i=this._assets.push(e)-1;this._cache[e.id]=i,this._names[e.name]||(this._names[e.name]=[]),this._names[e.name].push(i),e.file&&(t=e.file.url,this._urls[t]=i),e.registry=this,this._tags.addItem(e),e.tags.on("add",this._onTagAdd,this),e.tags.on("remove",this._onTagRemove,this),this.fire("add",e),this.fire("add:"+e.id,e),t&&this.fire("add:url:"+t,e),e.preload&&this.load(e)},remove:function(e){var t=this._cache[e.id],i=e.file?e.file.url:null;if(void 0!==t){this._assets.splice(t,1),delete this._cache[e.id],this._names={},this._urls=[];for(var r=0,a=this._assets.length;r<a;r++){var s=this._assets[r];this._cache[s.id]=r,this._names[s.name]||(this._names[s.name]=[]),this._names[s.name].push(r),s.file&&(this._urls[s.file.url]=r)}return this._tags.removeItem(e),e.tags.off("add",this._onTagAdd,this),e.tags.off("remove",this._onTagRemove,this),e.fire("remove",e),this.fire("remove",e),this.fire("remove:"+e.id,e),i&&this.fire("remove:url:"+i,e),!0}return!1},get:function(e){var t=this._cache[e];return this._assets[t]},getByUrl:function(e){var t=this._urls[e];return this._assets[t]},load:function(e){if(!e.loading){var t=this;if(!e.loaded){var i,r,a=!!e.file,s=e.getPreferredFile();s?a&&(this.fire("load:start",e),this.fire("load:"+e.id+":start",e),i=e.getFileUrl(),e.loading=!0,t._loader.load(i,e.type,function(i,r,a){if(e.loaded=!0,e.loading=!1,i)return t.fire("error",i,e),t.fire("error:"+e.id,i,e),void e.fire("error",i,e);if(r instanceof Array?e.resources=r:e.resource=r,"script"===e.type){var n=t._loader.getHandler("script");n._cache[e.id]&&n._cache[e.id].parentNode===document.head&&document.head.removeChild(n._cache[e.id]),n._cache[e.id]=a}t._loader.patch(e,t),t.fire("load",e),t.fire("load:"+e.id,e),s&&s.url&&t.fire("load:url:"+s.url,e),e.fire("load",e)},e)):((r=t._loader.open(e.type,e.data))instanceof Array?e.resources=r:e.resource=r,e.loaded=!0,t._loader.patch(e,t),t.fire("load",e),t.fire("load:"+e.id,e),s&&s.url&&t.fire("load:url:"+s.url,e),e.fire("load",e))}}},loadFromUrl:function(e,t,i){this.loadFromUrlAndFilename(e,null,t,i)},loadFromUrlAndFilename:function(e,t,i,r){var a=this,s=pc2d.path.getBasename(t||e),n={filename:t||s,url:e},o=a.getByUrl(e);o||(o=new pc2d.Asset(s,i,n,{}),a.add(o));var l=function(e){"material"===i?a._loadTextures([e],function(t,i){t?r(t):r(null,e)}):r(null,e)};o.resource?l(o):"model"!==i?(o.once("load",l),o.once("error",function(e){r(e)}),a.load(o)):a._loadModel(o,r)},_loadModel:function(e,t){var i=this,r=e.getFileUrl(),a=pc2d.path.getDirectory(r),s=pc2d.path.getBasename(r),n=pc2d.path.getExtension(r),o=function(r){e.once("load",function(e){t(null,e)}),e.once("error",function(e){t(e)}),i.load(r)};if(".json"===n||".glb"===n){var l=pc2d.path.join(a,s.replace(n,".mapping.json"));this._loader.load(l,"json",function(t,r){if(t)return e.data={mapping:[]},void o(e);i._loadMaterials(a,r,function(t,i){e.data=r,o(e)})})}else o(e)},_loadMaterials:function(e,t,i){e&&(e+="/",this.prefix&&e.startsWith(this.prefix)&&(e=e.slice(this.prefix.length)));var r,a=t.mapping.length,s=[];0===a&&i(null,s);var n=function(e,t){s.push(t),0===--a&&i(null,s)};for(r=0;r<t.mapping.length;r++){var o=t.mapping[r].path;o?(o=pc2d.path.join(e,o),this.loadFromUrl(o,"material",n)):a--}},_loadTextures:function(e,t){var i,r={},a=[],s=[],n=0;for(i=0;i<e.length;i++){var o=e[i].data;if("path"===o.mappingFormat){var l,d=e[i].getFileUrl(),h=pc2d.path.getDirectory(d);h&&(h+="/",this.prefix&&h.startsWith(this.prefix)&&(h=h.slice(this.prefix.length)));for(var f=0;f<pc2d.StandardMaterial.TEXTURE_PARAMETERS.length;f++){var c=pc2d.StandardMaterial.TEXTURE_PARAMETERS[f];if(o[c]&&"string"==typeof o[c]){var u=o[c];r[l=pc2d.path.join(h,u)]||(r[l]=!0,a.push(l),n++)}}}else console.warn("Skipping: "+e[i].name+', material files must be mappingFormat: "path" to be loaded from URL')}if(n){var p=function(e,i){s.push(i),n--,e&&console.error(e),0===n&&t(null,s)};for(i=0;i<a.length;i++)this.loadFromUrl(a[i],"texture",p)}else t(null,s)},findAll:function(e,t){var i=this,r=this._names[e];if(r){var a=r.map(function(e){return i._assets[e]});return t?a.filter(function(e){return e.type===t}):a}return[]},_onTagAdd:function(e,t){this._tags.add(e,t)},_onTagRemove:function(e,t){this._tags.remove(e,t)},findByTag:function(){return this._tags.find(arguments)},filter:function(e){for(var t=[],i=0,r=this._assets.length;i<r;i++)e(this._assets[i])&&t.push(this._assets[i]);return t},find:function(e,t){var i=this.findAll(e,t);return i?i[0]:null}}),{AssetRegistry:e}}());
},{}],"eC2T":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var e=function(e){this._handlers={},this._requests={},this._cache={},this._app=e};return Object.assign(e.prototype,{addHandler:function(e,s){this._handlers[e]=s,s._loader=this},removeHandler:function(e){delete this._handlers[e]},getHandler:function(e){return this._handlers[e]},load:function(e,s,t,n){var r=this._handlers[s];if(r){var i=e+s;if(void 0!==this._cache[i])t(null,this._cache[i]);else if(this._requests[i])this._requests[i].push(t);else{this._requests[i]=[t];var a=this,h=function(e,s){e?a._onFailure(i,e):r.load(s,function(e,t,h){if(a._requests[i])if(e)a._onFailure(i,e);else try{a._onSuccess(i,r.open(s.original,t,n),h)}catch(o){a._onFailure(i,o)}},n)},o=e.split("?")[0];if(this._app.enableBundles&&this._app.bundles.hasUrl(o)){if(!this._app.bundles.canLoadUrl(o))return void h("Bundle for "+e+" not loaded yet");this._app.bundles.loadUrl(o,function(s,t){h(s,{load:t,original:e})})}else h(null,{load:e,original:e})}}else{t("No handler for asset type: "+s)}},_onSuccess:function(e,s,t){this._cache[e]=s;for(var n=0;n<this._requests[e].length;n++)this._requests[e][n](null,s,t);delete this._requests[e]},_onFailure:function(e,s){if(console.error(s),this._requests[e]){for(var t=0;t<this._requests[e].length;t++)this._requests[e][t](s);delete this._requests[e]}},open:function(e,s){var t=this._handlers[e];return t?t.open(null,s):(console.warn("No resource handler found for: "+e),s)},patch:function(e,s){var t=this._handlers[e.type];t?t.patch&&t.patch(e,s):console.warn("No resource handler found for: "+e.type)},clearCache:function(e,s){delete this._cache[e+s]},getFromCache:function(e,s){if(this._cache[e+s])return this._cache[e+s]},enableRetry:function(){for(var e in this._handlers)this._handlers[e].retryRequests=!0},disableRetry:function(){for(var e in this._handlers)this._handlers[e].retryRequests=!1},destroy:function(){this._handlers={},this._requests={},this._cache={}}}),{ResourceLoader:e}}());
},{}],"QFso":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(t){this._app=t,this._scripts={},this._cache={}};return t._types=[],t._push=function(e){t._types.push(e)},Object.assign(t.prototype,{load:function(e,n){"string"==typeof e&&(e={load:e,original:e});var i=this;pc2d.script.app=this._app,this._loadScript(e.original,function(e,a,s){if(e)n(e);else if(pc2d.script.legacy){var c=null;t._types.length&&(c=t._types.pop()),c?this._scripts[a]=c:c=null,n(null,c,s)}else{for(var r={},p=0;p<t._types.length;p++)r[t._types[p].name]=t._types[p];t._types.length=0,n(null,r,s),delete i._loader._cache[a+"script"]}}.bind(this))},open:function(t,e){return e},patch:function(t,e){},_loadScript:function(t,e){var n=document.head,i=document.createElement("script");this._cache[t]=i,i.async=!1,i.addEventListener("error",function(t){e(pc2d.string.format("Script: {0} failed to load",t.target.src))},!1);var a=!1;i.onload=i.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,e(null,t,i))},i.src=t,n.appendChild(i)}}),{ScriptHandler:t}}());
},{}],"yJ6g":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var e=function(e,t){this._app=e,this._isTemplate=t};return Object.assign(e.prototype,{parse:function(e){var t,n,i={},a=null;for(t in e.collapsedInstances&&this._addCollapsedToEntities(this._app,e),e.entities)i[t]=this._createEntity(e.entities[t]),null===e.entities[t].parent&&(a=i[t]);for(t in e.entities){var s=e.entities[t].children.length;for(n=0;n<s;n++){var r=e.entities[t].children[n];i[r]&&i[t].addChild(i[r])}}return this._openComponentData(a,e.entities),a},_createEntity:function(e){var t=new pc2d.Entity;if(t.name=e.name,t.setGuid(e.resource_id),t._enabled=void 0===e.enabled||e.enabled,this._isTemplate||(t._enabledInHierarchy=t._enabled),t.template=e.template,e.tags)for(var n=0;n<e.tags.length;n++)t.tags.add(e.tags[n]);return e.labels&&e.labels.forEach(function(e){t.addLabel(e)}),t},_openComponentData:function(e,t){var n,i=this._app.systems.list,a=i.length,s=t[e.getGuid()];for(n=0;n<a;n++){var r=i[n],l=s.components[r.id];l&&r.addComponent(e,l)}a=s.children.length;var o=e._children;for(n=0;n<a;n++){if(!o[n])return;o[n]=this._openComponentData(o[n],t)}return e},_addCollapsedToEntities:function(e,t){t.collapsedInstances.forEach(function(n){var i=pc2d.TemplateUtils.expandTemplateEntities(e,n.instanceEntities);Object.assign(t.entities,i)})}}),{SceneParser:e}}());
},{}],"F1Er":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var e=function(e){this._app=e,this.retryRequests=!1};return Object.assign(e.prototype,{load:function(e,t){"string"==typeof e&&(e={load:e,original:e});var s=this._app.assets;pc2d.http.get(e.load,{retry:this.retryRequests},function(n,a){if(n){var i="Error while loading scene "+e.original;n.message?(i+=": "+n.message,n.stack&&(i+="\n"+n.stack)):i+=": "+n,t(i)}else pc2d.TemplateUtils.waitForTemplatesInScene(a,s,t)})},open:function(e,t){this._app.systems.script.preloading=!0;var s=new pc2d.SceneParser(this._app,!1).parse(t),n=this._app.scene;return n.root=s,this._app.applySceneSettings(t.settings),this._app.systems.script.preloading=!1,n},patch:function(e,t){}}),{SceneHandler:e}}());
},{}],"h5Y9":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var e=function(){this.retryRequests=!1};Object.assign(e.prototype,{load:function(e,t){var n;("string"==typeof e&&(e={load:e,original:e}),e.load.startsWith("data:text/css;"))?((n=document.createElement("link")).rel="stylesheet",n.href=e.load,document.head.appendChild(n),t(null,"")):((n=document.createElement("link")).rel="stylesheet",n.href=e.load,document.head.appendChild(n),t(null,""))},open:function(e,t){return t},patch:function(e,t){}});return{CssHandler:e,createStyle:function(e){var t=document.createElement("style");return t.type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),t}}}());
},{}],"F0TD":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(){this.retryRequests=!1};return Object.assign(t.prototype,{load:function(t,n){"string"==typeof t&&(t={load:t,original:t});var r={retry:this.retryRequests};t.load.startsWith("blob:")&&(r.responseType=pc2d.Http.ResponseType.JSON),pc2d.http.get(t.load,r,function(r,e){r?n(pc2d.string.format("Error loading JSON resource: {0} [{1}]",t.original,r)):n(null,e)})},open:function(t,n){return n},patch:function(t,n){}}),{JsonHandler:t}}());
},{}],"sGPX":[function(require,module,exports) {
Object.assign(pc,function(){"use strict";var t=function(t){this._app=t};return Object.assign(t.prototype,{load:function(t,e){"string"==typeof t&&(t={load:t,original:t});var n=this._app.assets;pc2d.http.get(t.load,function(i,a){i?e("Error requesting template: "+t.original):pc2d.TemplateUtils.waitForTemplateAssets(a.entities,n,e,a)})},open:function(t,e){return new pc2d.Template(this._app,e)}}),{TemplateHandler:t}}());
},{}],"hdWW":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";return{TemplateUtils:{waitForTemplatesInScene:function(t,e,n){if(t.collapsedInstances){var a=pc2d.TemplateUtils._getAllCollapsedEntities(t);pc2d.TemplateUtils.waitForTemplateAssets(a,e,n,t)}else n(null,t)},waitForTemplateAssets:function(t,e,n,a){var s=pc2d.TemplateUtils._extractTemplateIds(t);new pc2d.AssetListLoader(s,e).load(function(t){n(t,a)})},_getAllCollapsedEntities:function(t){var e={};return t.collapsedInstances.forEach(function(t){Object.assign(e,t.instanceEntities)}),e},_extractTemplateIds:function(t){var e=[];for(var n in t){var a=t[n].template_id;a&&e.push(a)}return e},expandTemplateEntities:function(t,e){var n={};for(var a in e){var s=e[a];n[a]=s.collapsed_entity?pc2d.TemplateUtils.expandEntity(t,s):s}return n},expandEntity:function(t,e){}}}}());
},{}],"X994":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(t,e){this._app=t,this._data=e,this._expandedData={},this._templateRoot=null};return t.prototype.instantiate=function(){return this._templateRoot||this._parseTemplate(),this._templateRoot.clone()},t.prototype.getExpandedData=function(){return this._expandedData.entities||(this._expandedData.entities=pc2d.TemplateUtils.expandTemplateEntities(this._app,this._data.entities)),this._expandedData},t.prototype._parseTemplate=function(){var t=new pc2d.SceneParser(this._app,!0);this._templateRoot=t.parse(this.getExpandedData())},{Template:t}}());
},{}],"AriX":[function(require,module,exports) {
Object.assign(pc2d,function(){"use strict";var t=function(t,e){pc2d.EventHandler.call(this),this.canvas=t,this._maxPixelRatio=1,this.renderTarget=null,this._width=0,this._height=0};return(t.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=t,Object.assign(t.prototype,{resizeCanvas:function(t,e){this._width=t,this._height=e;var i=Math.min(this._maxPixelRatio,window.devicePixelRatio);t*=i,e*=i,this.fire("resizecanvas",t,e)},setResolution:function(t,e){this._width=t,this._height=e,this.fire("resizecanvas",t,e)},destroy:function(){this.canvas=null}}),Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width}}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height}}),Object.defineProperty(t.prototype,"fullscreen",{get:function(){return!!document.fullscreenElement},set:function(t){t?this.canvas.requestFullscreen():document.exitFullscreen()}}),Object.defineProperty(t.prototype,"maxPixelRatio",{get:function(){return this._maxPixelRatio},set:function(t){this._maxPixelRatio=t,this.resizeCanvas(this._width,this._height)}}),{GraphicsDevice:t}}());
},{}],"FgGd":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=function(t,e){if(pc2d.GraphNode.call(this,t),t instanceof pc2d.Application&&(e=t),this._batchHandle=null,this.c={},this._app=e,!e&&(this._app=pc2d.Application.getApplication(),!this._app))throw new Error("Couldn't find current application");this._guid=null,this._destroying=!1};return(t.prototype=Object.create(pc2d.GraphNode.prototype)).constructor=t,t.prototype.addComponent=function(t,e){var n=this._app.systems[t];return n?this.c[t]?(console.warn("addComponent: Entity already has "+t+" component"),null):n.addComponent(this,e):(console.error("addComponent: System "+t+" doesn't exist"),null)},t.prototype.removeComponent=function(t){var e=this._app.systems[t];e?this.c[t]?e.removeComponent(this):console.warn("removeComponent: Entity doesn't have "+t+" component"):console.error("removeComponent: System "+t+" doesn't exist")},t.prototype.findComponent=function(t){var e=this.findOne(function(e){return e.c&&e.c[t]});return e&&e.c[t]},t.prototype.findComponents=function(t){return this.find(function(e){return e.c&&e.c[t]}).map(function(e){return e.c[t]})},t.prototype.getGuid=function(){return this._guid||this.setGuid(pc2d.guid.create()),this._guid},t.prototype.setGuid=function(t){var e=this._app._entityIndex;this._guid&&delete e[this._guid],this._guid=t,e[this._guid]=this},t.prototype._notifyHierarchyStateChanged=function(t,e){var n,i,o=!1;t===this&&0===this._app._enableList.length&&(o=!0),t._beingEnabled=!0,t._onHierarchyStateChanged(e),t._onHierarchyStatePostChanged&&this._app._enableList.push(t);var r=t._children;for(n=0,i=r.length;n<i;n++)r[n]._enabled&&this._notifyHierarchyStateChanged(r[n],e);if(t._beingEnabled=!1,o){for(n=0;n<this._app._enableList.length;n++)this._app._enableList[n]._onHierarchyStatePostChanged();this._app._enableList.length=0}},t.prototype._onHierarchyStateChanged=function(t){var e;pc2d.GraphNode.prototype._onHierarchyStateChanged.call(this,t);var n=this.c;for(var i in n)n.hasOwnProperty(i)&&(e=n[i]).enabled&&(t?e.onEnable():e.onDisable())},t.prototype._onHierarchyStatePostChanged=function(){var t=this.c;for(var e in t)t.hasOwnProperty(e)&&t[e].onPostStateChange()},t.prototype.findByGuid=function(t){if(this._guid===t)return this;var e=this._app._entityIndex[t];return e&&(e===this||e.isDescendantOf(this))?e:null},t.prototype.destroy=function(){var t;for(t in this._destroying=!0,this.c)this.c[t].enabled=!1;for(t in this.c)this.c[t].system.removeComponent(this);this._parent&&this._parent.removeChild(this);for(var e=this._children,n=e.shift();n;)n instanceof pc2d.Entity&&n.destroy(),n._parent=null,n=e.shift();this.fire("destroy",this),this.off(),this._guid&&delete this._app._entityIndex[this._guid],this._destroying=!1},t.prototype.clone=function(){var t={},e=this._cloneRecursively(t);return t[this.getGuid()]=e,function t(e,n,i,o){var r,s;if(n instanceof pc2d.Entity){var a=n.c;for(var p in a){var c=a[p],h=c.system.getPropertiesOfType("entity");for(r=0,s=h.length;r<s;r++){var d=h[r],l=d.name,u=c[l],y=!!e.findByGuid(u);if(y){var f=o[u].getGuid();f?i.c[p][l]=f:console.warn("Could not find corresponding entity id when resolving duplicated entity references")}}}a.script&&!i._app.useLegacyScriptAttributeCloning&&i.script.resolveDuplicatedEntityReferenceProperties(a.script,o);var _=n.children.filter(function(t){return t instanceof pc2d.Entity}),g=i.children.filter(function(t){return t instanceof pc2d.Entity});for(r=0,s=_.length;r<s;r++)t(e,_[r],g[r],o)}}(this,this,e,t),e},t.prototype.cloneShallow=function(){var t=new pc2d.Entity(this._app);for(var e in pc2d.GraphNode.prototype._cloneInternal.call(this,t),this.c){this.c[e].system.cloneComponent(this,t)}return t},t.prototype._cloneRecursively=function(t){var e,n=new pc2d.Entity(this._app);for(var i in pc2d.GraphNode.prototype._cloneInternal.call(this,n),this.c){this.c[i].system.cloneComponent(this,n)}for(e=0;e<this._children.length;e++){var o=this._children[e];if(o instanceof pc2d.Entity){var r=o._cloneRecursively(t);n.addChild(r),t[o.getGuid()]=r}}return n},{Entity:t}}());
},{}],"JoQH":[function(require,module,exports) {
pc2d.script=function(){var t=!1,c=!1,e={app:null,create:function(c,e){if(t){var n=e(pc2d.script.app);n._pcScriptName=c,pc2d.ScriptHandler._push(n),this.fire("created",c,e)}},attribute:function(t,c,e,n){},createLoadingScreen:function(t){c||(c=!0,t(pc2d.Application.getApplication()))}};return Object.defineProperty(e,"legacy",{get:function(){return t},set:function(c){t=c}}),pc2d.events.attach(e),e}();
},{}],"gcWv":[function(require,module,exports) {
Object.assign(pc2d,function(){var t=function(t){this._app=t,this._list=[],this._index={},this._urlIndex={}};return t.prototype.destroy=function(){this._app=null},t.prototype.list=function(){return this._list},t.prototype.add=function(t,e){if(this._index.hasOwnProperty(t))return console.warn("pc2d.SceneRegistry: trying to add more than one scene called: "+t),!1;var s=new pc2d.SceneRegistryItem(t,e),i=this._list.push(s);return this._index[s.name]=i-1,this._urlIndex[s.url]=i-1,!0},t.prototype.find=function(t){return this._index.hasOwnProperty(t)?this._list[this._index[t]]:null},t.prototype.findByUrl=function(t){return this._urlIndex.hasOwnProperty(t)?this._list[this._urlIndex[t]]:null},t.prototype.remove=function(t){if(this._index.hasOwnProperty(t)){var e=this._index[t],s=this._list[e];for(delete this._urlIndex[s.url],delete this._index[t],this._list.splice(e,1),e=0;e<this._list.length;e++)s=this._list[e],this._index[s.name]=e,this._urlIndex[s.url]=e}},t.prototype.loadSceneHierarchy=function(t,e){var s=this,i=this._app.loader.getHandler("hierarchy");this._app.assets&&this._app.assets.prefix&&!pc2d.ABSOLUTE_URL.test(t)&&(t=pc2d.path.join(this._app.assets.prefix,t)),i.load(t,function(p,n){if(p)e&&e(p);else{s._app._preloadScripts(n,function(){s._app.systems.script.preloading=!0;var r=i.open(t,n);s._app.systems.script.preloading=!1,s._app.loader.clearCache(t,"hierarchy"),s._app.root.addChild(r),pc2d.ComponentSystem.initialize(r),pc2d.ComponentSystem.postInitialize(r),e&&e(p,r)})}})},t.prototype.loadSceneSettings=function(t,e){var s=this;this._app.assets&&this._app.assets.prefix&&!pc2d.ABSOLUTE_URL.test(t)&&(t=pc2d.path.join(this._app.assets.prefix,t)),this._app.loader.load(t,"scenesettings",function(t,i){t?e&&e(t):(s._app.applySceneSettings(i),e&&e(null))})},t.prototype.loadScene=function(t,e){var s=this,i=this._app.loader.getHandler("scene");this._app.assets&&this._app.assets.prefix&&!pc2d.ABSOLUTE_URL.test(t)&&(t=pc2d.path.join(this._app.assets.prefix,t)),i.load(t,function(p,n){if(p)e&&e(p);else{s._app._preloadScripts(n,function(){s._app.systems.script.preloading=!0;var p=i.open(t,n);s._app.systems.script.preloading=!1,s._app.loader.clearCache(t,"scene"),s._app.loader.patch({resource:p,type:"scene"},s._app.assets),s._app.root.addChild(p.root),e&&e(null,p)})}})},{SceneRegistry:t,SceneRegistryItem:function(t,e){this.name=t,this.url=e}}}());
},{}],"iial":[function(require,module,exports) {
Object.assign(pc2d,function(){var e=function e(t,i){pc2d.EventHandler.call(this),i=i||{},e._applications[t.id]=this,e._currentApplication=this,pc2d.app=this,this._time=0,this.timeScale=1,this.maxDeltaTime=.1,this.frame=0,this.autoRender=!0,this.renderNextFrame=!1,this._librariesLoaded=!1,this._fillMode=pc2d.FILLMODE_KEEP_ASPECT,this._resolutionMode=pc2d.RESOLUTION_FIXED,this._allowResize=!0,this.context=this,this.graphicsDevice=new pc2d.GraphicsDevice(t),this.loader=new pc2d.ResourceLoader(this),this._entityIndex={},this.rootIframe=t,this.scene={},this.root=new pc2d.Entity(this),this.rootIframe.contentWindow?(this.root.buildinStyle=document.createElement("style"),this.root.buildinStyle.type="text/css",this.root.dom=this.rootIframe.contentWindow.document.body,this.root.head=this.rootIframe.contentWindow.document.head,this.root.head.appendChild(this.root.buildinStyle)):(this.root.dom=t,this.root.head=document.head),this.root._enabledInHierarchy=!0,this._enableList=[],this._enableList.size=0,this.assets=new pc2d.AssetRegistry(this.loader),this.scriptsOrder=i.scriptsOrder||[],this.scripts=new pc2d.ScriptRegistry(this),this.scenes=new pc2d.SceneRegistry(this),this.loader.addHandler("scene",new pc2d.SceneHandler(this)),this.loader.addHandler("template",new pc2d.TemplateHandler(this)),this.loader.addHandler("script",new pc2d.ScriptHandler(this)),this.loader.addHandler("css",new pc2d.CssHandler(this)),this.loader.addHandler("json",new pc2d.JsonHandler(this)),this._visibilityChangeHandler=this.onVisibilityChange.bind(this),this.systems=new pc2d.ComponentSystemRegistry,this.systems.add(new pc2d.ScriptComponentSystem(this)),this.systems.add(new pc2d.CssComponentSystem(this)),"undefined"!=typeof document&&(void 0!==document.hidden?(this._hiddenAttr="hidden",document.addEventListener("visibilitychange",this._visibilityChangeHandler,!1)):void 0!==document.mozHidden?(this._hiddenAttr="mozHidden",document.addEventListener("mozvisibilitychange",this._visibilityChangeHandler,!1)):void 0!==document.msHidden?(this._hiddenAttr="msHidden",document.addEventListener("msvisibilitychange",this._visibilityChangeHandler,!1)):void 0!==document.webkitHidden&&(this._hiddenAttr="webkitHidden",document.addEventListener("webkitvisibilitychange",this._visibilityChangeHandler,!1))),this.tick=s(this)};(e.prototype=Object.create(pc2d.EventHandler.prototype)).constructor=e,e._currentApplication=null,e._applications={},e.getApplication=function(t){return t?e._applications[t]:e._currentApplication};var t=function(e){this.length=e,this.count=0,this.inc=function(){this.count++},this.done=function(){return this.count===this.length}};Object.defineProperty(e.prototype,"fillMode",{get:function(){return this._fillMode}}),Object.defineProperty(e.prototype,"resolutionMode",{get:function(){return this._resolutionMode}}),Object.assign(e.prototype,{configure:function(e,t){var i=this;pc2d.http.get(e,function(e,s){if(e)t(e);else{var n=s.application_properties,r=s.scenes,o=s.assets;i._parseApplicationProperties(n,function(e){i._parseScenes(r),i._parseAssets(o),t(e||null)})}})},preload:function(e){var i,s,n=this;n.fire("preload:start");var r=this.assets.list({preload:!0}),o=new t(r.length),a=!1,d=function(){n.graphicsDevice&&!a&&o.done()&&(a=!0,n.fire("preload:end"),e())};s=r.length;var h=function(){return o.count};if(o.length){var l=function(e){o.inc(),n.fire("preload:progress",h()/s),o.done()&&d()},c=function(e,t){o.inc(),n.fire("preload:progress",h()/s),o.done()&&d()};for(i=0;i<r.length;i++)r[i].loaded?(o.inc(),n.fire("preload:progress",h()/s),o.done()&&d()):(r[i].once("load",l),r[i].once("error",c),this.assets.load(r[i]))}else d()},getSceneUrl:function(e){var t=this.scenes.find(e);return t?t.url:null},loadSceneHierarchy:function(e,t){this.scenes.loadSceneHierarchy(e,t)},loadSceneSettings:function(e,t){this.scenes.loadSceneSettings(e,t)},loadScene:function(e,t){this.scenes.loadScene(e,t)},_preloadScripts:function(e,i){if(pc2d.script.legacy){var s=this;s.systems.script.preloading=!0;var n,r=this._getScriptReferences(e),o=0,a=r.length,d=new t(a),h=/^http(s)?:\/\//;if(a){var l=function(e,t){e&&console.error(e),d.inc(),d.done()&&(s.systems.script.preloading=!1,i())};for(o=0;o<a;o++)n=r[o],!h.test(n.toLowerCase())&&s._scriptPrefix&&(n=pc2d.path.join(s._scriptPrefix,r[o])),this.loader.load(n,"script",l)}else s.systems.script.preloading=!1,i()}else i()},_parseApplicationProperties:function(e,t){var i,s;if(e.useDevicePixelRatio||(e.useDevicePixelRatio=e.use_device_pixel_ratio),e.resolutionMode||(e.resolutionMode=e.resolution_mode),e.fillMode||(e.fillMode=e.fill_mode),this._width=e.width,this._height=e.height,e.useDevicePixelRatio&&(this.graphicsDevice.maxPixelRatio=window.devicePixelRatio),this.setCanvasResolution(e.resolutionMode,this._width,this._height),this.setCanvasFillMode(e.fillMode,this._width,this._height),e.layers&&e.layerOrder){var n=new pc2d.LayerComposition,r={};for(var o in e.layers){var a=e.layers[o];a.id=parseInt(o,10),a.enabled=a.id!==pc2d.LAYERID_DEPTH,r[o]=new pc2d.Layer(a)}for(i=0,s=e.layerOrder.length;i<s;i++){var d=e.layerOrder[i],h=r[d.layer];h&&(d.transparent?n.pushTransparent(h):n.pushOpaque(h),n.subLayerEnabled[i]=d.enabled)}this.scene.layers=n}if(e.batchGroups)for(i=0,s=e.batchGroups.length;i<s;i++){var l=e.batchGroups[i];this.batcher.addGroup(l.name,l.dynamic,l.maxAabbSize,l.id,l.layers)}e.i18nAssets&&(this.i18n.assets=e.i18nAssets),this._loadLibraries(e.libraries,t)},_loadLibraries:function(e,t){var i=e.length,s=i,n=this,r=/^http(s)?:\/\//;if(i)for(var o=function(e,i){s--,e?t(e):0===s&&(n.onLibrariesLoaded(),t(null))},a=0;a<i;++a){var d=e[a];!r.test(d.toLowerCase())&&n._scriptPrefix&&(d=pc2d.path.join(n._scriptPrefix,d)),this.loader.load(d,"script",o)}else n.onLibrariesLoaded(),t(null)},_parseScenes:function(e){if(e)for(var t=0;t<e.length;t++)this._sceneRegistry.add(e[t].name,e[t].url)},_parseAssets:function(e){var t,i,s=[],n={},r={};if(!pc2d.script.legacy){for(t=0;t<this.scriptsOrder.length;t++)e[i=this.scriptsOrder[t]]&&(n[i]=!0,s.push(e[i]));if(this.enableBundles)for(i in e)"bundle"===e[i].type&&(r[i]=!0,s.push(e[i]));for(i in e)n[i]||r[i]||s.push(e[i])}for(t=0;t<s.length;t++){var o=s[t],a=new pc2d.Asset(o.name,o.type,o.file,o.data);if(a.id=o.id,a.preload=!!o.preload&&o.preload,a.loaded="script"===o.type&&o.data&&o.data.loadingType>0,a.tags.add(o.tags),o.i18n)for(var d in o.i18n)a.addLocalizedAssetId(d,o.i18n[d]);this.assets.add(a)}},_getScriptReferences:function(e){var t,i,s=[];e.settings.priority_scripts&&(s=e.settings.priority_scripts);var n=[],r={};for(t=0;t<s.length;t++)n.push(s[t]),r[s[t]]=!0;var o=e.entities;for(i in o)if(o[i].components.script){var a=o[i].components.script.scripts;for(t=0;t<a.length;t++)r[a[t].url]||(n.push(a[t].url),r[a[t].url]=!0)}return n},start:function(){this.frame=0,this.fire("start",{timestamp:pc2d.now(),target:this}),this._librariesLoaded||this.onLibrariesLoaded(),pc2d.ComponentSystem.initialize(this.root),this.fire("initialize"),pc2d.ComponentSystem.postInitialize(this.root),this.fire("postinitialize"),this.tick()},update:function(e){this.frame++,pc2d.ComponentSystem.update(e,this._inTools),pc2d.ComponentSystem.postUpdate(e,this._inTools),this.fire("update",e),this.controller&&this.controller.update(e),this.mouse&&this.mouse.update(e),this.keyboard&&this.keyboard.update(e),this.gamepads&&this.gamepads.update(e)},render:function(){this.fire("prerender"),this.root.syncHierarchy(),this.batcher&&this.batcher.updateAll(),pc2d._skipRenderCounter=0,this.renderer&&this.renderer.renderComposition(this.scene.layers),this.fire("postrender")},setCanvasFillMode:function(e,t,i){this._fillMode=e,this.resizeCanvas(t,i)},setCanvasResolution:function(e,t,i){this._resolutionMode=e,e===pc2d.RESOLUTION_AUTO&&void 0===t&&(t=this.graphicsDevice.canvas.clientWidth,i=this.graphicsDevice.canvas.clientHeight),this.graphicsDevice.resizeCanvas(t,i)},isHidden:function(){return document[this._hiddenAttr]},onVisibilityChange:function(){this.isHidden()?this.fire("visibilityHidden"):this.fire("visibilityVisible")},resizeCanvas:function(e,t){if(this._allowResize){var i=window.innerWidth,s=window.innerHeight;if(this._fillMode===pc2d.FILLMODE_KEEP_ASPECT){var n=this.graphicsDevice.canvas.width/this.graphicsDevice.canvas.height;n>i/s?t=(e=i)/n:e=(t=s)*n}else this._fillMode===pc2d.FILLMODE_FILL_WINDOW&&(e=i,t=s);return this._resolutionMode===pc2d.RESOLUTION_AUTO&&this.setCanvasResolution(pc2d.RESOLUTION_AUTO),{width:e,height:t}}},onLibrariesLoaded:function(){this._librariesLoaded=!0},applySceneSettings:function(e){},_processTimestamp:function(e){return e},destroy:function(){var t,i,s=this.graphicsDevice.canvas.id;this.off("librariesloaded"),document.removeEventListener("visibilitychange",this._visibilityChangeHandler,!1),document.removeEventListener("mozvisibilitychange",this._visibilityChangeHandler,!1),document.removeEventListener("msvisibilitychange",this._visibilityChangeHandler,!1),document.removeEventListener("webkitvisibilitychange",this._visibilityChangeHandler,!1),this._visibilityChangeHandler=null,this.onVisibilityChange=null,this.root.destroy(),this.root=null,this.mouse&&(this.mouse.off(),this.mouse.detach(),this.mouse=null),this.keyboard&&(this.keyboard.off(),this.keyboard.detach(),this.keyboard=null),this.touch&&(this.touch.off(),this.touch.detach(),this.touch=null),this.elementInput&&(this.elementInput.detach(),this.elementInput=null),this.controller&&(this.controller=null);var n=this.systems.list;for(t=0,i=n.length;t<i;t++)n[t].destroy();pc2d.ComponentSystem.destroy();var r=this.assets.list();for(t=0;t<r.length;t++)r[t].unload(),r[t].off();for(var o in this.assets.off(),this.loader.getHandler("script")._cache){var a=this.loader.getHandler("script")._cache[o],d=a.parentNode;d&&d.removeChild(a)}this.loader.getHandler("script")._cache={},this.loader.destroy(),this.loader=null,this.scene.destroy(),this.scene=null,this.systems=[],this.context=null,this.scripts.destroy(),this.scripts=null,this._sceneRegistry.destroy(),this._sceneRegistry=null,this.lightmapper.destroy(),this.lightmapper=null,this.batcher.destroyManager(),this.batcher=null,this._entityIndex={},this.defaultLayerDepth.onPreRenderOpaque=null,this.defaultLayerDepth.onPostRenderOpaque=null,this.defaultLayerDepth.onDisable=null,this.defaultLayerDepth.onEnable=null,this.defaultLayerDepth=null,this.defaultLayerWorld=null,pc2d.destroyPostEffectQuad(),this.vr&&(this.vr.destroy(),this.vr=null),this.xr.end(),this.graphicsDevice.destroy(),this.graphicsDevice=null,this.renderer=null,this.tick=null,this.off(),this._audioManager&&(this._audioManager.destroy(),this._audioManager=null),pc2d.http=new pc2d.Http,pc2d.script.app=null,pc2d.ParticleEmitter.DEFAULT_PARAM_TEXTURE=null,e._applications[s]=null,e._currentApplication===this&&(e._currentApplication=null)},getEntityFromIndex:function(e){return this._entityIndex[e]}});var i={},s=function(t){var s,n=t;return function(t,r){if(n.graphicsDevice){e._currentApplication=n,s&&(window.cancelAnimationFrame(s),s=null),pc2d.app=n;var o=n._processTimestamp(t)||pc2d.now(),a=(o-(n._time||o))/1e3;a=pc2d.math.clamp(a,0,n.maxDeltaTime),a*=n.timeScale,n._time=o,s=window.requestAnimationFrame(n.tick),n.update(a),(n.autoRender||n.renderNextFrame)&&(n.render(),n.renderNextFrame=!1),i.timestamp=pc2d.now(),i.target=n,n.fire("frameend",i),n.fire("frameEnd",i)}}};return{FILLMODE_NONE:"NONE",FILLMODE_FILL_WINDOW:"FILL_WINDOW",FILLMODE_KEEP_ASPECT:"KEEP_ASPECT",RESOLUTION_AUTO:"AUTO",RESOLUTION_FIXED:"FIXED",Application:e}}());
},{}],"kOqG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./core/pc2d-core.js"));function r(e){return e&&e.__esModule?e:{default:e}}require("./core/pc2d-eventhandle.js"),require("./core/pc2d-tags.js"),require("./math/math.js"),require("./math/curve.js"),require("./math/curve-set.js"),require("./math/curve-evaluator.js"),require("./math/vec2.js"),require("./math/vec3.js"),require("./math/vec4.js"),require("./framework/utils/sorted-loop-array.js"),require("./framework/components/data.js"),require("./framework/components/component.js"),require("./framework/components/system.js"),require("./framework/components/register.js"),require("./framework/components/script/data.js"),require("./framework/components/script/component.js"),require("./framework/components/script/system.js"),require("./framework/components/css/data.js"),require("./framework/components/css/component.js"),require("./framework/components/css/system.js"),require("./pc2d-graphnode-web.js"),require("./net/http.js"),require("./script/script.js"),require("./script/script-type.js"),require("./script/script-attributes.js"),require("./script/script-registry.js"),require("./asset/asset-list-loader.js"),require("./asset/asset-variant.js"),require("./asset/asset.js"),require("./asset/asset-registry.js"),require("./resources/loader.js"),require("./resources/script.js"),require("./resources/parser/scene-web.js"),require("./resources/scene.js"),require("./resources/css.js"),require("./resources/json.js"),require("./resources/template.js"),require("./template/template-utils.js"),require("./template/template.js"),require("./graphics/device.js"),require("./framework/pc2d-entity.js"),require("./framework/pc2d-script.js"),require("./framework/pc2d-scene-registry.js"),require("./framework/pc2d-application.js");var s=e.default;exports.default=s;
},{"./core/pc2d-core.js":"pZpx","./core/pc2d-eventhandle.js":"Wzxt","./core/pc2d-tags.js":"rRJb","./math/math.js":"URv2","./math/curve.js":"tjMb","./math/curve-set.js":"cgEA","./math/curve-evaluator.js":"BW6Q","./math/vec2.js":"lN7n","./math/vec3.js":"e7O6","./math/vec4.js":"Be36","./framework/utils/sorted-loop-array.js":"ebdD","./framework/components/data.js":"cGaP","./framework/components/component.js":"pcLQ","./framework/components/system.js":"J27z","./framework/components/register.js":"FU0h","./framework/components/script/data.js":"g6C3","./framework/components/script/component.js":"IsKF","./framework/components/script/system.js":"nSdp","./framework/components/css/data.js":"qeuV","./framework/components/css/component.js":"kJIN","./framework/components/css/system.js":"PnI4","./pc2d-graphnode-web.js":"QnoE","./net/http.js":"sEMV","./script/script.js":"JVpL","./script/script-type.js":"UOvr","./script/script-attributes.js":"UF00","./script/script-registry.js":"zAKT","./asset/asset-list-loader.js":"gUmX","./asset/asset-variant.js":"nAWy","./asset/asset.js":"yrto","./asset/asset-registry.js":"OzPz","./resources/loader.js":"eC2T","./resources/script.js":"QFso","./resources/parser/scene-web.js":"yJ6g","./resources/scene.js":"F1Er","./resources/css.js":"h5Y9","./resources/json.js":"F0TD","./resources/template.js":"sGPX","./template/template-utils.js":"hdWW","./template/template.js":"X994","./graphics/device.js":"AriX","./framework/pc2d-entity.js":"FgGd","./framework/pc2d-script.js":"JoQH","./framework/pc2d-scene-registry.js":"gcWv","./framework/pc2d-application.js":"iial"}]},{},["kOqG"], null)
//# sourceMappingURL=/pc2d-entry.js.map